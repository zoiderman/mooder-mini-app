(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,752591,e=>{"use strict";e.s(["default",()=>t]);let t=(0,e.i(510965).default)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},164877,e=>{"use strict";e.s(["AlertTriangle",()=>t.default]);var t=e.i(752591)},186679,e=>{"use strict";e.s(["DelayedRender",()=>n]);var t=e.i(353315);function n(e){let{children:n,delayMs:r=200}=e,[o,a]=(0,t.useState)(!1);return(0,t.useEffect)(()=>{let e=setTimeout(()=>{a(!0)},r);return()=>{clearTimeout(e)}},[r]),o?n:null}},820380,e=>{"use strict";e.s(["parseSelector",()=>n]);let t=/[#.]/g;function n(e,n){let r,o,a=e||"",i={},l=0;for(;l<a.length;){t.lastIndex=l;let e=t.exec(a),n=a.slice(l,e?e.index:a.length);n&&(r?"#"===r?i.id=n:Array.isArray(i.className)?i.className.push(n):i.className=[n]:o=n,l+=n.length),e&&(r=e[0],l++)}return{type:"element",tagName:o||n||"div",properties:i,children:[]}}},589955,e=>{"use strict";e.s(["hasProperty",()=>n]);let t={}.hasOwnProperty;function n(e,n){let r="element"===e.type&&t.call(e.properties,n)&&e.properties[n];return null!=r&&!1!==r}},593522,13330,e=>{"use strict";e.s(["FileError",()=>l],593522);var t=e.i(637651),n=e.i(763578),r=e.i(211959);e.i(685846);var o=e.i(164877);e.s(["RefreshCw",()=>a],13330);let a=(0,e.i(510965).default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.i(968648);var i=e.i(873329);function l(e){let{onRetryRequested:l,title:s,message:c}=e,{t:u}=(0,i.useTranslation)("files");return(0,t.jsxs)("div",{className:(0,r.cn)("flex flex-col items-center justify-center h-full w-full p-4"),children:[(0,t.jsx)(o.AlertTriangle,{className:"mb-4",size:24}),(0,t.jsx)("h2",{className:"text-md font-semibold mb-2",children:s||u("file-open-error.title","Could not open file")}),(0,t.jsx)("p",{className:"text-sm text-fg-secondary mb-4 text-center max-w-sm",children:c||u("file-open-error.message","Something went wrong while trying to load the document. Please check your connection and try again.")}),l&&(0,t.jsxs)(n.Button,{variant:"outline",size:"md",onClick:l,className:"flex items-center gap-2",children:[(0,t.jsx)(a,{size:16,className:"text-fg-secondary"}),(0,t.jsx)("span",{className:"text-fg-primary font-semibold",children:u("file-open-error.retry","Retry")})]})]})}},767321,279236,241546,591169,245056,814251,866600,968009,e=>{"use strict";e.s(["parse",()=>M],767321);var t,n={},r={};function o(e){if(0===e.length)return n;for(var t={},r=0;r<e.length;r++)!function(e,t){for(var n=t,r=0;r<e.length;r++){var o=r===e.length-1,a=e.charAt(r),i=n[a]||(n[a]={chars:{}});o&&(i.self=e),n=i.chars}}(e[r],t);return t}var a={},i={type:"String",optional:!0};function l(e){for(var t=function(e){for(var t={},n=0,r=Object.keys(e);n<r.length;n++){var o=r[n],a=e[o];if(a)for(var i=0;i<a.length;i++){var l=a[i];(t[l]||(t[l]=[])).push(o)}}return t}(e),n={},r=0,o=Object.keys(t);r<o.length;r++){var a=o[r],i=t[a];i&&(n[a]=function(e){var t={type:"NoArgument",optional:!1};function n(e){if(t.type&&t.type!==e&&"NoArgument"!==t.type)throw Error('Conflicting pseudo-class argument type: "'.concat(t.type,'" vs "').concat(e,'".'));t.type=e}for(var r=0;r<e.length;r++){var o=e[r];"NoArgument"===o&&(t.optional=!0),"Formula"===o&&n("Formula"),"FormulaOfSelector"===o&&(n("Formula"),t.ofSelector=!0),"String"===o&&n("String"),"Selector"===o&&n("Selector")}return t}(i))}return n}var s=function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},c={},u={wildcard:!0};function d(e,t){return function(n,r){return!0===r?e:t(!0===n?e:n,r)}}function f(e){return function(t,n){if(!n||!t)return n;if("object"!=typeof n||null===n)throw Error("Unexpected syntax definition extension type: ".concat(n,"."));for(var r=s({},t),o=0,a=Object.entries(n);o<a.length;o++){var i=a[o],l=i[0],c=i[1];if("latest"!==l){var u=e[l];r[l]=u(t[l],c)}}return r}}function p(e,t){return void 0!==t?t:e}function h(e,t){return t?e?e.concat(t):t:e}function m(e,t){if(!t)return e;if(!e)return t;for(var n=s({},e),r=0,o=Object.entries(t);r<o.length;r++){var a=o[r],i=a[0],l=a[1];if(!l){delete n[i];continue}var c=e[i];if(!c){n[i]=l;continue}n[i]=c.concat(l)}return n}var g=(t=f({baseSyntax:p,modules:h,tag:d(u,f({wildcard:p})),ids:p,classNames:p,namespace:d(u,f({wildcard:p})),combinators:h,attributes:f({operators:h,caseSensitivityModifiers:h,unknownCaseSensitivityModifiers:p}),pseudoClasses:f({unknown:p,definitions:m}),pseudoElements:f({unknown:p,notation:p,definitions:function(e,t){return function(n,r){return t(e(n),e(r))}}(function(e){return Array.isArray(e)?{NoArgument:e}:e},m)})}),function(e,n){var r=t(e,n);if(!r)throw Error("Syntax definition cannot be null or undefined.");return r}),O={tag:{},ids:!0,classNames:!0,combinators:[],pseudoElements:{unknown:"reject",notation:"singleColon",definitions:["first-letter","first-line"]},pseudoClasses:{unknown:"reject",definitions:{NoArgument:["link","visited","active"]}}},v=g(O,{tag:{wildcard:!0},combinators:[">","+"],attributes:{unknownCaseSensitivityModifiers:"reject",operators:["=","~=","|="]},pseudoElements:{definitions:["before","after"]},pseudoClasses:{unknown:"reject",definitions:{NoArgument:["hover","focus","first-child"],String:["lang"]}}}),S=g(v,{namespace:{wildcard:!0},combinators:["~"],attributes:{operators:["^=","$=","*="]},pseudoElements:{notation:"both"},pseudoClasses:{definitions:{NoArgument:["root","last-child","first-of-type","last-of-type","only-child","only-of-type","empty","target","enabled","disabled","checked","indeterminate"],Formula:["nth-child","nth-last-child","nth-of-type","nth-last-of-type"],Selector:["not"]}}}),y=g(S,{combinators:["||"],attributes:{caseSensitivityModifiers:["i","I","s","S"]},pseudoClasses:{definitions:{NoArgument:["any-link","local-link","target-within","scope","current","past","future","focus-within","focus-visible","read-write","read-only","placeholder-shown","default","valid","invalid","in-range","out-of-range","required","optional","blank","user-invalid","playing","paused","autofill","modal","fullscreen","picture-in-picture","defined","loading","popover-open"],Formula:["nth-col","nth-last-col"],String:["dir"],FormulaOfSelector:["nth-child","nth-last-child"],Selector:["current","is","where","has","state"]}},pseudoElements:{definitions:{NoArgument:["marker"],Selector:["part"]}}}),b={"css-position-1":{latest:!1,pseudoClasses:{definitions:{NoArgument:["static","relative","absolute"]}}},"css-position-2":{latest:!1,pseudoClasses:{definitions:{NoArgument:["static","relative","absolute","fixed"]}}},"css-position-3":{latest:!1,pseudoClasses:{definitions:{NoArgument:["sticky","fixed","absolute","relative","static"]}}},"css-position-4":{latest:!0,pseudoClasses:{definitions:{NoArgument:["sticky","fixed","absolute","relative","static","initial"]}}},"css-scoping-1":{latest:!0,pseudoClasses:{definitions:{NoArgument:["host","host-context"],Selector:["host","host-context"]}},pseudoElements:{definitions:{Selector:["slotted"]}}},"css-pseudo-4":{latest:!0,pseudoElements:{definitions:{NoArgument:["marker","selection","target-text","search-text","spelling-error","grammar-error","backdrop","file-selector-button","prefix","postfix","placeholder","details-content"],String:["highlight"]}}},"css-shadow-parts-1":{latest:!0,pseudoElements:{definitions:{Selector:["part"]}}}},w=s(s({},y),{modules:Object.entries(b).filter(function(e){return e[1].latest}).map(function(e){return e[0]})}),x=g(w,{pseudoElements:{unknown:"accept"},pseudoClasses:{unknown:"accept"},attributes:{unknownCaseSensitivityModifiers:"accept"}}),P={css1:O,css2:v,css3:S,"selectors-3":S,"selectors-4":y,latest:w,progressive:x},C=function(){for(var e={pseudoClasses:{},pseudoElements:{}},t=0,n=["css1","css2","css3","selectors-3","selectors-4"];t<n.length;t++){var r=n[t],o=P[r];if(o.pseudoClasses&&"object"==typeof o.pseudoClasses){var a=o.pseudoClasses.definitions;if(a)for(var i=0,l=Object.entries(a);i<l.length;i++)for(var s=l[i][1],c=0,u=s;c<u.length;c++){var d=u[c];e.pseudoClasses[d]||(e.pseudoClasses[d]=[]),e.pseudoClasses[d].includes(r)||e.pseudoClasses[d].push(r)}}if(o.pseudoElements&&"object"==typeof o.pseudoElements){var a=o.pseudoElements.definitions;if(a)if(Array.isArray(a))for(var f=0,p=a;f<p.length;f++){var h=p[f];e.pseudoElements[h]||(e.pseudoElements[h]=[]),e.pseudoElements[h].includes(r)||e.pseudoElements[h].push(r)}else for(var m=0,g=Object.values(a);m<g.length;m++)for(var s=g[m],O=0,v=s;O<v.length;O++){var S=v[O];e.pseudoElements[S]||(e.pseudoElements[S]=[]),e.pseudoElements[S].includes(r)||e.pseudoElements[S].push(r)}}}for(var y=0,w=Object.entries(b);y<w.length;y++){var x=w[y],C=x[0],E=x[1];if(E.pseudoClasses&&"object"==typeof E.pseudoClasses){var a=E.pseudoClasses.definitions;if(a)for(var k=0,Q=Object.values(a);k<Q.length;k++)for(var s=Q[k],R=0,A=s;R<A.length;R++){var T=A[R];e.pseudoClasses[T]||(e.pseudoClasses[T]=[]),e.pseudoClasses[T].includes(C)||e.pseudoClasses[T].push(C)}}if(E.pseudoElements&&"object"==typeof E.pseudoElements){var a=E.pseudoElements.definitions;if(a)if(Array.isArray(a))for(var N=0,W=a;N<W.length;N++){var q=W[N];e.pseudoElements[q]||(e.pseudoElements[q]=[]),e.pseudoElements[q].includes(C)||e.pseudoElements[q].push(C)}else for(var I=0,M=Object.values(a);I<M.length;I++)for(var s=M[I],X=0,D=s;X<D.length;X++){var j=D[X];e.pseudoElements[j]||(e.pseudoElements[j]=[]),e.pseudoElements[j].includes(C)||e.pseudoElements[j].push(C)}}}return e}();function E(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||"-"===e||"_"===e||"\\"===e||e>=" "}function k(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e>="0"&&e<="9"||"-"===e||"_"===e||e>=" "}function Q(e){return e>="a"&&e<="f"||e>="A"&&e<="F"||e>="0"&&e<="9"}var R={" ":!0,"	":!0,"\n":!0,"\r":!0,"\f":!0},A={'"':!0,"'":!0},T={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0},N="css-selector-parser parse error: ",W=function(){return(W=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function q(e){return function(t,n){var r;return(r={})[t]=function(t){return W({type:e},t)},r[n]=function(t){return"object"==typeof t&&null!==t&&t.type===e},r}}W(W(W(W(W(W(W(W(W(W(W(W(W(W(W(W({},q("Selector")("selector","isSelector")),q("Rule")("rule","isRule")),q("TagName")("tagName","isTagName")),q("Id")("id","isId")),q("ClassName")("className","isClassName")),q("WildcardTag")("wildcardTag","isWildcardTag")),q("NamespaceName")("namespaceName","isNamespaceName")),q("WildcardNamespace")("wildcardNamespace","isWildcardNamespace")),q("NoNamespace")("noNamespace","isNoNamespace")),q("Attribute")("attribute","isAttribute")),q("PseudoClass")("pseudoClass","isPseudoClass")),q("PseudoElement")("pseudoElement","isPseudoElement")),q("String")("string","isString")),q("Formula")("formula","isFormula")),q("FormulaOfSelector")("formulaOfSelector","isFormulaOfSelector")),q("Substitution")("substitution","isSubstitution"));let I=function(e){void 0===e&&(e={});var t,s=e.syntax,d=void 0===s?"latest":s,f=e.substitutes,p=e.strict,h=void 0===p||p,m=e.modules,O="object"==typeof d?d:P[d];if(O.baseSyntax&&(O=g(P[O.baseSyntax],O)),O.modules&&O.modules.length>0)for(var v=0,S=O.modules;v<S.length;v++){var y=b[S[v]];y&&(O=g(y,O))}if(m&&m.length>0)for(var w=0;w<m.length;w++){var y=b[m[w]];y&&(O=g(y,O))}var x=O.tag?[!0,!!(!(t=O.tag)?c:"boolean"==typeof t?u:t).wildcard]:[!1,!1],W=x[0],q=x[1],I=!!O.ids,M=!!O.classNames,X=!!O.namespace,D=O.namespace&&(!0===O.namespace||!0===O.namespace.wildcard);if(X&&!W)throw Error("".concat(N,"Namespaces cannot be enabled while tags are disabled."));var j=!!f,z=O.combinators?o(O.combinators):n,_=O.attributes?[!0,O.attributes.operators?o(O.attributes.operators):n,O.attributes.caseSensitivityModifiers?function(e){if(0===e.length)return r;for(var t={},n=0;n<e.length;n++)t[e[n]]=!0;return t}(O.attributes.caseSensitivityModifiers):r,"accept"===O.attributes.unknownCaseSensitivityModifiers]:[!1,n,r,!1],B=_[0],V=_[1],F=_[2],L=_[3],U=L||Object.keys(F).length>0,G=O.pseudoClasses?[!0,O.pseudoClasses.definitions?l(O.pseudoClasses.definitions):a,"accept"===O.pseudoClasses.unknown]:[!1,a,!1],Y=G[0],Z=G[1],$=G[2],H=O.pseudoElements?[!0,"singleColon"===O.pseudoElements.notation||"both"===O.pseudoElements.notation,!O.pseudoElements.notation||"doubleColon"===O.pseudoElements.notation||"both"===O.pseudoElements.notation,O.pseudoElements.definitions?l(Array.isArray(O.pseudoElements.definitions)?{NoArgument:O.pseudoElements.definitions}:O.pseudoElements.definitions):a,"accept"===O.pseudoElements.unknown]:[!1,!1,!1,a,!1],J=H[0],K=H[1],ee=H[2],et=H[3],en=H[4],er="",eo=er.length,ea=0,ei="",el=function(e){return ei===e},es=function(){return el("*")||E(ei)},ec=function(e){ea=e,ei=er.charAt(ea)},eu=function(){ea++,ei=er.charAt(ea)},ed=function(){var e=ei;return ea++,ei=er.charAt(ea),e};function ef(e){var t=Math.min(eo-1,ea),n=Error("".concat(N).concat(e," Pos: ").concat(t,"."));throw n.position=t,n.name="ParserError",n}function ep(e,t){if(!e)return ef(t)}var eh=function(){ep(ea<eo,"Unexpected end of input.")},em=function(){return ea>=eo},eg=function(e){ep(ea<eo,'Expected "'.concat(e,'" but end of input reached.')),ep(ei===e,'Expected "'.concat(e,'" but "').concat(ei,'" found.')),ea++,ei=er.charAt(ea)};function eO(e){var t=function e(t,n){var r=t[er.charAt(n)];if(r){var o=e(r.chars,n+1);if(o)return o;if(r.self)return r.self}}(e,ea);if(t)return ea+=t.length,ei=er.charAt(ea),t}function ev(){for(var e=ed(),t=1;Q(ei)&&t<6;)e+=ed(),t++;return function(){if(" "===ei||"	"===ei||"\f"===ei||"\n"===ei)return eu();"\r"===ei&&eu(),"\n"===ei&&eu()}(),String.fromCharCode(parseInt(e,16))}function eS(){if(!E(ei))return null;for(var e="";el("-");)e+=ei,eu();for("-"!==e||k(ei)||el("\\")||ef("Identifiers cannot consist of a single hyphen."),h&&e.length>=2&&ef("Identifiers cannot start with two hyphens with strict mode on."),T[ei]&&ef("Identifiers cannot start with hyphens followed by digits.");ea<eo;)if(k(ei))e+=ed();else if(el("\\"))eu(),eh(),Q(ei)?e+=ev():e+=ed();else break;return e}function ey(){for(;R[ei];)eu()}function eb(e){void 0===e&&(e=!1),ey();for(var t=[eE(e)];el(",");)eu(),ey(),t.push(eE(e));return{type:"Selector",rules:t}}function ew(){for(var e="";T[ei];)e+=ed();return ep(""!==e,"Formula parse error."),parseInt(e)}function ex(e,t,n){var r;if(el("(")){if(eu(),ey(),j&&el("$")){eu();var o=eS();ep(o,"Expected substitute name."),r={type:"Substitution",name:o}}else if("String"===n.type)ep((r={type:"String",value:function(){for(var e="";ea<eo;)if(el(")"))break;else if(el("\\")){if(eu(),em()&&!h)return(e+"\\").trim();eh(),Q(ei)?e+=ev():e+=ed()}else e+=ed();return e.trim()}()}).value,"Expected ".concat(t," argument value."));else if("Selector"===n.type)r=eb(!0);else{if("Formula"!==n.type)return ef("Invalid ".concat(t," signature."));var a=function(){if(el("e")||el("o")){var e,t=eS();if("even"===t)return ey(),[2,0];if("odd"===t)return ey(),[2,1]}var n=null,r=1;if(el("-")&&(eu(),r=-1),(el("-")||el("+")||T[ei])&&(el("+")&&eu(),n=ew(),!el("\\")&&!el("n")))return[0,n*r];if(null===n&&(n=1),n*=r,el("\\")?(eu(),e=Q(ei)?ev():ed()):e=ed(),ep("n"===e,'Formula parse error: expected "n".'),ey(),!(el("+")||el("-")))return[n,0];var o=el("+")?1:-1;return eu(),ey(),[n,o*ew()]}(),i=a[0],l=a[1];r={type:"Formula",a:i,b:l},n.ofSelector&&(ey(),(el("o")||el("\\"))&&(ep("of"===eS(),"Formula of selector parse error."),ey(),r={type:"FormulaOfSelector",a:i,b:l,selector:eE()}))}if(ey(),em()&&!h)return r;eg(")")}else ep(n.optional,"Argument is required for ".concat(t,' "').concat(e,'".'));return r}function eP(){if(el("*"))return ep(q,"Wildcard tag name is not enabled."),eu(),{type:"WildcardTag"};if(!E(ei))return ef("Expected tag name.");ep(W,"Tag names are not enabled.");var e=eS();return ep(e,"Expected tag name."),{type:"TagName",name:e}}function eC(){if(el("*")){var e=ea;if(eu(),!el("|")||(eu(),!es()))return ec(e),eP();ep(X,"Namespaces are not enabled."),ep(D,"Wildcard namespace is not enabled.");var t=eP();return t.namespace={type:"WildcardNamespace"},t}if(el("|")){ep(X,"Namespaces are not enabled."),eu();var t=eP();return t.namespace={type:"NoNamespace"},t}if(!E(ei))return ef("Expected tag name.");var n=eS();if(ep(n,"Expected tag name."),!el("|"))return ep(W,"Tag names are not enabled."),{type:"TagName",name:n};var e=ea;if(eu(),!es())return ec(e),{type:"TagName",name:n};ep(X,"Namespaces are not enabled.");var t=eP();return t.namespace={type:"NamespaceName",name:n},t}function eE(e){void 0===e&&(e=!1);var t,n,r={type:"Rule",items:[]};if(e){var o=eO(z);o&&(r.combinator=o,ey())}for(;ea<eo;)if(es())ep(0===r.items.length,"Unexpected tag/namespace start."),r.items.push(eC());else if(el("|")){var a=ea;if(eu(),es())ep(0===r.items.length,"Unexpected tag/namespace start."),ec(a),r.items.push(eC());else{ec(a);break}}else if(el(".")){ep(M,"Class names are not enabled."),eu();var l=eS();ep(l,"Expected class name."),r.items.push({type:"ClassName",name:l})}else if(el("#")){ep(I,"IDs are not enabled."),eu();var s=eS();ep(s,"Expected ID name."),r.items.push({type:"Id",name:s})}else if(el("["))ep(B,"Attributes are not enabled."),r.items.push(function(){if(eg("["),ey(),el("|")){ep(X,"Namespaces are not enabled."),eu();var e,t=eS();ep(t,"Expected attribute name."),e={type:"Attribute",name:t,namespace:{type:"NoNamespace"}}}else if(el("*")){ep(X,"Namespaces are not enabled."),ep(D,"Wildcard namespace is not enabled."),eu(),eg("|");var n=eS();ep(n,"Expected attribute name."),e={type:"Attribute",name:n,namespace:{type:"WildcardNamespace"}}}else{var r=eS();if(ep(r,"Expected attribute name."),e={type:"Attribute",name:r},el("|")){var o=ea;if(eu(),E(ei)){ep(X,"Namespaces are not enabled.");var a=eS();ep(a,"Expected attribute name."),e={type:"Attribute",name:a,namespace:{type:"NamespaceName",name:r}}}else ec(o)}}if(ep(e.name,"Expected attribute name."),ey(),em()&&!h)return e;if(el("]"))eu();else{if(e.operator=eO(V),ep(e.operator,"Expected a valid attribute selector operator."),ey(),eh(),A[ei])e.value={type:"String",value:function(e){var t="";for(eg(e);ea<eo;)if(el(e)){eu();break}else el("\\")?(eu(),el(e)?(t+=e,eu()):"\n"===ei||"\f"===ei?eu():"\r"===ei?(eu(),el("\n")&&eu()):Q(ei)?t+=ev():(t+=ei,eu())):(t+=ei,eu());return t}(ei)};else if(j&&el("$")){eu();var i=eS();ep(i,"Expected substitute name."),e.value={type:"Substitution",name:i}}else{var l=eS();ep(l,"Expected attribute value."),e.value={type:"String",value:l}}if(ey(),em()&&!h)return e;if(!el("]")){var s=eS();if(ep(s,"Expected end of attribute selector."),e.caseSensitivityModifier=s,ep(U,"Attribute case sensitivity modifiers are not enabled."),ep(L||F[e.caseSensitivityModifier],"Unknown attribute case sensitivity modifier."),ey(),em()&&!h)return e}eg("]")}return e}());else if(el(":")){var c=!1;eu(),el(":")&&(ep(J,"Pseudo elements are not enabled."),ep(ee,"Pseudo elements double colon notation is not enabled."),c=!0,eu());var u=eS();if(ep(c||u,"Expected pseudo-class name."),ep(!c||u,"Expected pseudo-element name."),ep(u,"Expected pseudo-class name."),!c||en||Object.prototype.hasOwnProperty.call(et,u));else{var d=C.pseudoElements[u],f='Unknown pseudo-element "'.concat(u,'"');d&&d.length>0&&(f+=". It is defined in: ".concat(d.join(", "))),ef(f+".")}if(J&&(c||!c&&K&&Object.prototype.hasOwnProperty.call(et,u))){var p=null!=(t=et[u])?t:en&&i,m={type:"PseudoElement",name:u},g=ex(u,"pseudo-element",p);g&&(ep("Formula"!==g.type&&"FormulaOfSelector"!==g.type,"Pseudo-elements cannot have formula argument."),m.argument=g),r.items.push(m)}else{ep(Y,"Pseudo-classes are not enabled.");var p=null!=(n=Z[u])?n:$&&i;if(p);else{var d=C.pseudoClasses[u],f='Unknown pseudo-class: "'.concat(u,'"');d&&d.length>0&&(f+=". It is defined in: ".concat(d.join(", "))),ef(f+".")}var g=ex(u,"pseudo-class",p),O={type:"PseudoClass",name:u};g&&(O.argument=g),r.items.push(O)}}else break;if(0===r.items.length)if(em())return ef("Expected rule but end of input reached.");else return ef('Expected rule but "'.concat(ei,'" found.'));if(ey(),!em()&&!el(",")&&!el(")")){var o=eO(z);ey(),r.nestedRule=eE(),r.nestedRule.combinator=o}return r}return function(e){if("string"!=typeof e)throw Error("".concat(N,"Expected string input."));return eo=(er=e).length,ea=0,ei=er.charAt(0),eb()}}({syntax:"selectors-4"});function M(e){if("string"!=typeof e)throw TypeError("Expected `string` as selector, not `"+e+"`");return I(e)}e.s(["enterState",()=>L],241546);let X="֑-߿יִ-﷽ﹰ-ﻼ",D="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿‎Ⰰ-﬜︀-﹯﻽-￿",j=RegExp("^[^"+D+"]*["+X+"]"),z=RegExp("^[^"+X+"]*["+D+"]");function _(e){return"children"in e?function e(t){let n=-1,r=[];for(;++n<t.children.length;){var o;r[n]="text"===(o=t.children[n]).type?o.value:"children"in o?e(o):""}return r.join("")}(e):"value"in e?e.value:""}e.s(["toString",()=>_],279236);var B=e.i(61634),V=e.i(939049),F=e.i(446207);function L(e,t){let n,r=e.schema,o=e.language,a=e.direction,i=e.editableOrEditingHost;if("element"===t.type){let o=t.properties.xmlLang||t.properties.lang,a=t.properties.type||"text",i=G(t);null!=o&&(e.language=String(o)),r&&"html"===r.space?("true"===t.properties.contentEditable&&(e.editableOrEditingHost=!0),"svg"===t.tagName&&(e.schema=B.svg),"rtl"===i?n=i:"ltr"===i||"auto"!==i&&"html"===t.tagName||"auto"!==i&&"input"===t.tagName&&"tel"===a?n="ltr":("auto"===i||"bdi"===t.tagName)&&("textarea"===t.tagName?n=U(_(t)):"input"===t.tagName&&("email"===a||"search"===a||"tel"===a||"text"===a)?n=t.properties.value?U(String(t.properties.value)):"ltr":(0,F.visit)(t,function(e){return"text"===e.type?(n=U(e.value))?V.EXIT:void 0:e!==t&&"element"===e.type&&("bdi"===e.tagName||"script"===e.tagName||"style"===e.tagName||"textare"===e.tagName||G(e))?V.SKIP:void 0})),n&&(e.direction=n)):e.editableOrEditingHost&&(e.editableOrEditingHost=!1)}return function(){e.schema=r,e.language=o,e.direction=a,e.editableOrEditingHost=i}}function U(e){let t=function(e){let t=String(e||"");return j.test(t)?"rtl":z.test(t)?"ltr":"neutral"}(e);return"neutral"===t?void 0:t}function G(e){let t="element"===e.type&&"string"==typeof e.properties.dir?e.properties.dir.toLowerCase():void 0;return"auto"===t||"ltr"===t||"rtl"===t?t:void 0}e.s(["attribute",()=>J],591169);var Y=e.i(816220),Z=e.i(897802),$=e.i(273638),H=e.i(722365);function J(e,t,n){let r=(0,$.find)(n,e.name),o=function(e,t){if(null==e);else if("boolean"==typeof e){if(e)return t.attribute}else if(!Array.isArray(e))return String(e);else if(e.length>0)return(t.commaSeparated?Y.stringify:H.stringify)(e)}(t.properties[r.property],r);if(!e.value)return void 0!==o;(0,Z.ok)("String"===e.value.type,"expected plain string");let a=e.value.value;if("i"===e.caseSensitivityModifier&&(a=a.toLowerCase(),o&&(o=o.toLowerCase())),void 0!==o)switch(e.operator){case"=":return a===o;case"$=":return a===o.slice(-a.length);case"*=":return o.includes(a);case"^=":return a===o.slice(0,a.length);case"|=":return a===o||a===o.slice(0,a.length)&&"-"===o.charAt(a.length);case"~=":return a===o||H.parse(o).includes(a)}return!1}e.s(["className",()=>ee],245056);let K=[];function ee(e,t){return(t.properties.className||K).includes(e.name)}function et(e,t){return t.properties.id===e.name}function en(e,t){return e.name===t.tagName}function er(e,t){return function(n,r){let o=ea(n,"tag"),a=ea(null==r?"*":r,"range"),i=[],l=-1;for(;++l<a.length;){let n=a[l].toLowerCase();if(!t&&"*"===n)continue;let r=-1,s=[];for(;++r<o.length;)if(e(o[r].toLowerCase(),n)){if(!t)return o[r];i.push(o[r])}else s.push(o[r]);o=s}return t?i:void 0}}e.s(["id",()=>et],814251),e.s(["name",()=>en],866600),e.s(["extendedFilter",()=>eo],968009),er(function(e,t){return"*"===t||e===t||e.includes(t+"-")},!0);let eo=er(function(e,t){let n=e.split("-"),r=t.split("-"),o=0,a=0;if("*"!==r[0]&&n[o]!==r[a])return!1;for(o++,a++;a<r.length;){if("*"===r[a]){a++;continue}if(!n[o])return!1;if(n[o]===r[a]){o++,a++;continue}if(1===n[o].length)return!1;o++}return!0},!0);function ea(e,t){let n=e&&"string"==typeof e?[e]:e;if(!n||"object"!=typeof n||!("length"in n))throw Error("Invalid "+t+" `"+n+"`, expected non-empty string");return n}er(function(e,t){let n=t;for(;;){if("*"===n||e===n)return!0;let t=n.lastIndexOf("-");if(t<0)return!1;"-"===n.charAt(t-2)&&(t-=2),n=n.slice(0,t)}},!1)},737219,(e,t,n)=>{t.exports={trueFunc:function(){return!0},falseFunc:function(){return!1}}},506327,e=>{"use strict";e.s(["select",()=>T,"selectAll",()=>N],506327);var t=e.i(61634),n=e.i(767321),r=e.i(241546),o=e.i(591169),a=e.i(245056),i=e.i(814251),l=e.i(866600),s=e.i(968009),c=e.i(816220),u=e.i(897802),d=e.i(589955),f=e.i(158206);let p=new Set([9,10,12,13,32]);var h=e.i(737219);function m(e){return function(e){let t=e[0],n=e[1]-1;if(n<0&&t<=0)return h.default.falseFunc;if(-1===t)return e=>e<=n;if(0===t)return e=>e===n;if(1===t)return n<0?h.default.trueFunc:e=>e>=n;let r=Math.abs(t),o=(n%r+r)%r;return t>1?e=>e>=n&&e%r===o:e=>e<=n&&e%r===o}(function(e){if("even"===(e=e.trim().toLowerCase()))return[2,0];if("odd"===e)return[2,1];let t=0,n=0,r=a(),o=i();if(t<e.length&&"n"===e.charAt(t)&&(t++,n=r*(null!=o?o:1),l(),t<e.length?(r=a(),l(),o=i()):r=o=0),null===o||t<e.length)throw Error("n-th rule couldn't be parsed ('".concat(e,"')"));return[n,r*o];function a(){return"-"===e.charAt(t)?(t++,-1):("+"===e.charAt(t)&&t++,1)}function i(){let n=t,r=0;for(;t<e.length&&e.charCodeAt(t)>=48&&57>=e.charCodeAt(t);)r=10*r+(e.charCodeAt(t)-48),t++;return t===n?null:r}function l(){for(;t<e.length&&p.has(e.charCodeAt(t));)t++}}(e))}var g=e.i(79694);let O=m.default||m,v=(0,g.zwitch)("name",{handlers:{"any-link":function(e,t){return("a"===t.tagName||"area"===t.tagName||"link"===t.tagName)&&(0,d.hasProperty)(t,"href")},blank:function(e,t){return!C(t,function(e){return"element"===e.type||"text"===e.type&&!(0,f.whitespace)(e)})},checked:function(e,t){return"input"===t.tagName||"menuitem"===t.tagName?!!(("checkbox"===t.properties.type||"radio"===t.properties.type)&&(0,d.hasProperty)(t,"checked")):"option"===t.tagName&&(0,d.hasProperty)(t,"selected")},dir:function(e,t,n,r,o){return(0,u.ok)(e.argument,"expected `argument`"),(0,u.ok)("String"===e.argument.type,"expected plain text"),o.direction===e.argument.value},disabled:y,empty:function(e,t){return!C(t,function(e){return"element"===e.type||"text"===e.type})},enabled:function(e,t){return!y(e,t)},"first-child":function(e,t,n,r,o){return S(o,e),0===o.elementIndex},"first-of-type":function(e,t,n,r,o){return S(o,e),0===o.typeIndex},has:function(e,t,n,r,o){(0,u.ok)(e.argument,"expected `argument`"),(0,u.ok)("Selector"===e.argument.type,"expected selector");let a={...o,found:!1,one:!0,results:[],rootQuery:e.argument,scopeElements:[t],shallow:!1};return k(a,{type:"root",children:t.children}),a.results.length>0},is:w,lang:function(e,t,n,r,o){return(0,u.ok)(e.argument,"expected `argument`"),(0,u.ok)("String"===e.argument.type,"expected string"),""!==o.language&&void 0!==o.language&&(0,s.extendedFilter)(o.language,(0,c.parse)(e.argument.value)).length>0},"last-child":function(e,t,n,r,o){return S(o,e),!!(o.elementCount&&o.elementIndex===o.elementCount-1)},"last-of-type":function(e,t,n,r,o){return S(o,e),"number"==typeof o.typeIndex&&"number"==typeof o.typeCount&&o.typeIndex===o.typeCount-1},not:function(e,t,n,r,o){return!w(e,t,n,r,o)},"nth-child":function(e,t,n,r,o){let a=b(e);return S(o,e),"number"==typeof o.elementIndex&&a(o.elementIndex)},"nth-last-child":function(e,t,n,r,o){let a=b(e);return S(o,e),!!("number"==typeof o.elementCount&&"number"==typeof o.elementIndex&&a(o.elementCount-o.elementIndex-1))},"nth-last-of-type":function(e,t,n,r,o){let a=b(e);return S(o,e),"number"==typeof o.typeCount&&"number"==typeof o.typeIndex&&a(o.typeCount-1-o.typeIndex)},"nth-of-type":function(e,t,n,r,o){let a=b(e);return S(o,e),"number"==typeof o.typeIndex&&a(o.typeIndex)},"only-child":function(e,t,n,r,o){return S(o,e),1===o.elementCount},"only-of-type":function(e,t,n,r,o){return S(o,e),1===o.typeCount},optional:function(e,t){return!P(e,t)},"read-only":function(e,t,n,r,o){return!x(e,t,n,r,o)},"read-write":x,required:P,root:function(e,t,n,r,o){return!!((!r||"root"===r.type)&&o.schema&&("html"===o.schema.space||"svg"===o.schema.space)&&("html"===t.tagName||"svg"===t.tagName))},scope:function(e,t,n,r,o){return o.scopeElements.includes(t)}},invalid:function(){(0,u.unreachable)("Invalid pseudo-selector")},unknown:function(e){throw Error("Unknown pseudo-selector `"+e.name+"`")}});function S(e,t){if(e.shallow)throw Error("Cannot use `:"+t.name+"` without parent")}function y(e,t){return("button"===t.tagName||"input"===t.tagName||"select"===t.tagName||"textarea"===t.tagName||"optgroup"===t.tagName||"option"===t.tagName||"menuitem"===t.tagName||"fieldset"===t.tagName)&&(0,d.hasProperty)(t,"disabled")}function b(e){let t=e._cachedFn;if(!t){let n=e.argument;if((0,u.ok)(n,"expected `argument`"),"Formula"!==n.type)throw Error("Expected `nth` formula, such as `even` or `2n+1` (`of` is not yet supported)");e._cachedFn=t=O(n.a+"n+"+n.b)}return t}function w(e,t,n,r,o){(0,u.ok)(e.argument,"expected `argument`"),(0,u.ok)("Selector"===e.argument.type,"expected selector");let a={...o,found:!1,one:!0,results:[],rootQuery:e.argument,scopeElements:[t],shallow:!1};return k(a,t),a.results[0]===t}function x(e,t,n,r,o){return"input"===t.tagName||"textarea"===t.tagName?!(0,d.hasProperty)(t,"readOnly")&&!(0,d.hasProperty)(t,"disabled"):!!o.editableOrEditingHost}function P(e,t){return("input"===t.tagName||"textarea"===t.tagName||"select"===t.tagName)&&(0,d.hasProperty)(t,"required")}function C(e,t){let n=e.children,r=-1;for(;++r<n.length;)if(t(n[r]))return!0;return!1}let E=[];function k(e,t){t&&function e(t,n,s,c,u,d){let f={adjacentSibling:void 0,descendant:void 0,directChild:void 0,generalSibling:void 0},p=(0,r.enterState)(t,s);if("element"===s.type){let e=t.rootQuery.rules;u&&u!==d&&(e=t.rootQuery.rules.filter(e=>void 0===e.combinator||">"===e.combinator&&u===d)),f=function(e,t,n,r,s){let c={adjacentSibling:void 0,descendant:void 0,directChild:void 0,generalSibling:void 0},u=-1;for(;++u<t.length;){let d=t[u];if(e.one&&e.found)break;if(e.shallow&&d.nestedRule)throw Error("Expected selector without nesting");if(function(e,t,n,r,s){for(let c of e.items)if("Attribute"===c.type){if(!(0,o.attribute)(c,t,s.schema))return!1}else if("Id"===c.type){if(!(0,i.id)(c,t))return!1}else if("ClassName"===c.type){if(!(0,a.className)(c,t))return!1}else if("PseudoClass"===c.type){if(!v(c,t,n,r,s))return!1}else if("PseudoElement"===c.type)throw Error("Invalid selector: `::"+c.name+"`");else if("TagName"===c.type&&!(0,l.name)(c,t))return!1;return!0}(d,n,r,s,e)){let t=d.nestedRule;t?Q(c,"+"===t.combinator?"adjacentSibling":"~"===t.combinator?"generalSibling":">"===t.combinator?"directChild":"descendant",t):(e.found=!0,e.results.includes(n)||e.results.push(n))}void 0===d.combinator?Q(c,"descendant",d):"~"===d.combinator&&Q(c,"generalSibling",d)}return c}(t,R(n,e),s,c,u)}return"children"in s&&!t.shallow&&!(t.one&&t.found)&&function(t,n,r,o){let a,i=R(n.descendant,n.directChild),l=-1,s={count:0,types:new Map},c={count:0,types:new Map};for(;++l<r.children.length;)A(s,r.children[l]);for(l=-1;++l<r.children.length;){let n=r.children[l],u="element"===n.type?n.tagName.toUpperCase():void 0;if(t.elementIndex=c.count,t.typeIndex=u&&c.types.get(u)||0,t.elementCount=s.count,t.typeCount=u?s.types.get(u):0,"children"in n){let n=e(t,R(i,a),r.children[l],l,r,o);a=R(n.generalSibling,n.adjacentSibling)}if(t.one&&t.found)break;A(c,r.children[l])}}(t,f,s,d),p(),f}(e,[],t,void 0,void 0,t)}function Q(e,t,n){let r=e[t];r?r.push(n):e[t]=[n]}function R(e,t){return e&&t&&e.length>0&&t.length>0?[...e,...t]:e&&e.length>0?e:t&&t.length>0?t:E}function A(e,t){if("element"===t.type){let n=t.tagName.toUpperCase(),r=(e.types.get(n)||0)+1;e.count++,e.types.set(n,r)}}function T(e,t,n){let r=W(e,t,n);return r.one=!0,k(r,t||void 0),r.results[0]}function N(e,t,n){let r=W(e,t,n);return k(r,t||void 0),r.results}function W(e,r,o){return{direction:"ltr",editableOrEditingHost:!1,elementCount:void 0,elementIndex:void 0,found:!1,language:void 0,one:!1,results:[],rootQuery:(0,n.parse)(e),schema:"svg"===o?t.svg:t.html,scopeElements:r?"root"===r.type?r.children:[r]:[],shallow:!1,typeIndex:void 0,typeCount:void 0}}},280327,e=>{"use strict";e.s(["arrayToTable",()=>O,"copyTableToClipboard",()=>g,"delimitTable",()=>m],280327);var t=e.i(506327),n=e.i(570846),r=e.i(279236),o=e.i(61634),a=e.i(816220),i=e.i(820380),l=e.i(273638),s=e.i(360285),c=e.i(722365);function u(e,t,n){let r=n?function(e){let t=new Map;for(let n of e)t.set(n.toLowerCase(),n);return t}(n):void 0;return function(n,o){let s;for(var u=arguments.length,f=Array(u>2?u-2:0),p=2;p<u;p++)f[p-2]=arguments[p];if(null==n)s={type:"root",children:[]},f.unshift(o);else{let u=(s=(0,i.parseSelector)(n,t)).tagName.toLowerCase(),p=r?r.get(u):void 0;if(s.tagName=p||u,function(e){if(null===e||"object"!=typeof e||Array.isArray(e))return!0;if("string"!=typeof e.type)return!1;for(let t of Object.keys(e)){let n=e[t];if(n&&"object"==typeof n){if(!Array.isArray(n))return!0;for(let e of n)if("number"!=typeof e&&"string"!=typeof e)return!0}}return!!("children"in e&&Array.isArray(e.children))}(o))f.unshift(o);else for(let[t,n]of Object.entries(o))!function(e,t,n,r){let o,i=(0,l.find)(e,n);if(null!=r){if("number"==typeof r){if(Number.isNaN(r))return;o=r}else o="boolean"==typeof r?r:"string"==typeof r?i.spaceSeparated?(0,c.parse)(r):i.commaSeparated?(0,a.parse)(r):i.commaOrSpaceSeparated?(0,c.parse)((0,a.parse)(r).join(" ")):d(i,i.property,r):Array.isArray(r)?[...r]:"style"===i.property?function(e){let t=[];for(let[n,r]of Object.entries(e))t.push([n,r].join(": "));return t.join("; ")}(r):String(r);if(Array.isArray(o)){let e=[];for(let t of o)e.push(d(i,i.property,t));o=e}"className"===i.property&&Array.isArray(t.className)&&(o=t.className.concat(o)),t[i.property]=o}}(e,s.properties,t,n)}for(let e of f)!function e(t,n){if(null==n);else if("number"==typeof n||"string"==typeof n)t.push({type:"text",value:String(n)});else if(Array.isArray(n))for(let r of n)e(t,r);else if("object"==typeof n&&"type"in n)"root"===n.type?e(t,n.children):t.push(n);else throw Error("Expected node, nodes, or string, got `"+n+"`")}(s.children,e);return"element"===s.type&&"template"===s.tagName&&(s.content={type:"root",children:s.children},s.children=[]),s}}function d(e,t,n){if("string"==typeof n){if(e.number&&n&&!Number.isNaN(Number(n)))return Number(n);if((e.boolean||e.overloadedBoolean)&&(""===n||(0,s.normalize)(n)===(0,s.normalize)(t)))return!0}return n}let f=u(o.html,"div");u(o.svg,"g",["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","solidColor","textArea","textPath"]);let p={csv:",",tsv:"	"};function h(e,t){let n=e.includes(t)||e.includes("\n")||e.includes('"'),r=e.replace(/"/g,'""');return n?'"'.concat(r,'"'):r}function m(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"csv",{headers:o,rows:a}=function(e){if("element"!==e.type||"table"!==e.tagName)throw Error("Expected a <table> element");let n=(0,t.select)("thead tr",e);return{headers:n?(0,t.selectAll)("th,td",n).map(r.toString).map(e=>e.trim()):[],rows:((0,t.selectAll)("tbody tr",e).length?(0,t.selectAll)("tbody tr",e):(0,t.selectAll)("tr",e).filter(e=>e!==n)).map(e=>(0,t.selectAll)("th,td",e).map(r.toString).map(e=>e.trim()))}}(e),i=p[n],l=[];for(let e of(o.length&&l.push(o.map(e=>h(e.trim(),i)).join(i)),a))l.push(e.map(e=>h(e.trim(),i)).join(i));return l.join("\n")}function g(e,t){var r;let o=m(e,"csv"),a='<style type="text/css"><!--br {mso-data-placement:same-cell;}--></style>'+(0,n.toHtml)(e),i=e=>{var t;null==(t=window.navigator.clipboard)||t.writeText(e)};(null==(r=window.navigator.clipboard)?void 0:r.write)!==void 0||(null==t?void 0:t.clipboardData)!==void 0?((e,n)=>{var r,o,a;try{if(void 0===t||null===t.clipboardData)throw Error("No clipboard data");null==t||null==(r=t.clipboardData)||r.setData("text/plain",e),null==t||null==(o=t.clipboardData)||o.setData("text/html",n)}catch(t){((null==(a=window.navigator.clipboard)?void 0:a.write)===void 0||(window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([e],{type:"text/plain"}),"text/html":new Blob([n],{type:"text/html"})})]),0))&&i(e)}})(o,a):i(o),null==t||t.preventDefault()}function O(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.length)return f("table");let[n,...r]=e,o=e=>t=>f("tr",t.map(t=>f(e,t))),a=t&&n?f("thead",o("th")(n)):null,i=f("tbody",(t?r:e).map(o("td")));return f("table",[a,i].filter(Boolean))}},117521,e=>{"use strict";e.s(["EditorStateModel",()=>o,"getEditorView",()=>l]);var t=e.i(868275),n=e.i(564448);class r{updateState(e){this.set(e)}constructor(e,n){(0,t._)(this,"set",void 0),(0,t._)(this,"get",void 0),(0,t._)(this,"activeId",void 0),(0,t._)(this,"nodes",void 0),this.set=e,this.get=n,this.activeId=null,this.nodes={}}}class o{get state(){return this.view.state}setNodeProps(e){i.instance.updateState(t=>{var n;let r=null!=(n=t.nodes[this.id])?n:{};return t.nodes[this.id]={...r,...e},t})}get node(){return this.state.nodes[this.id]}destroy(){this.view.removeModel(this.id),i.instance.updateState(e=>(delete e.nodes[this.id],e))}static typeId(e,t){if(e in o.types)throw Error("Duplicate use of model type "+e);return o.types[e]=t,t.prototype.type=e,t}constructor(e){if((0,t._)(this,"id",void 0),(0,t._)(this,"view",void 0),this.id=e,!o.view)throw Error("EditorStateModel must be initialized with a valid EditorView");this.view=o.view,this.view.appendModel(this)}}(0,t._)(o,"view",void 0),(0,t._)(o,"types",Object.create(null));let a=e=>e;class i{static get instance(){return i.privateInstance||(i.privateInstance=new i),i.privateInstance}get state(){return this._state.getState()}updateState(e){this._state.setState(e)}appendModel(e){return void 0===this.models[e.id]&&(this.models[e.id]=e,!0)}removeModel(e){return!!this.models[e]&&(delete this.models[e],!0)}getModel(e){return this.models[e]}findById(e,t){e="string"==typeof e?o.types[e]:e;let n=this.models[t];if(void 0!==n&&n instanceof e)return n}useState(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;return this._state(e)}constructor(){(0,t._)(this,"models",{}),(0,t._)(this,"_state",void 0),this._state=(0,n.createImmerStore)(r,"EditorStateStore"),o.view=this}}function l(){return i.instance}(0,t._)(i,"privateInstance",void 0)},596222,505784,e=>{"use strict";e.s(["GridSelection",()=>C,"SpreadsheetModel",()=>A,"SpreadsheetStoreProvider",()=>k,"useSpreadsheet",()=>T],596222);var t=e.i(868275),n=e.i(637651),r=e.i(280327),o=e.i(186679),a=e.i(315366),i=e.i(723008),l=e.i(117521),s=e.i(250267),c=e.i(353315);e.i(968648);var u=e.i(873329),d=e.i(593522),f=e.i(536488);function p(){let e=T().error,{showBoundary:t,resetBoundary:n}=(0,f.useErrorBoundary)();return(0,c.useEffect)(()=>{e?t(e):n()},[e,t,n]),null}e.s(["colIndexToLabel",()=>v,"isCellSelection",()=>y,"isColSelection",()=>w,"isRangeSelection",()=>b,"isRowSelection",()=>x,"parseCellAddress",()=>m,"parseRange",()=>g,"rowIndexToLabel",()=>O,"selectionLabel",()=>P],505784);let h=/^(\$?)([A-Za-z]+)(\$?)(\d+)$/;function m(e){var t;let n=h.exec(e.trim());if(!n)throw Error('Invalid cell address: "'.concat(e,'"'));let[r,o,a,i,l]=n;if(void 0===a||void 0===l)throw Error('Invalid cell address: "'.concat(e,'"'));return{col:1===(t=a).length?t.toUpperCase().charCodeAt(0)-65:t.split("").reduce((e,t)=>26*e+(t.toUpperCase().charCodeAt(0)-64),0)-1,row:Number(l)-1}}function g(e){let[t,n=t]=e.split(":");if(void 0===t||void 0===n)throw Error('Invalid range: "'.concat(e,'"'));let{col:r,row:o}=m(t),{col:a,row:i}=m(n);return{rowStart:Math.min(o,i),rowEnd:Math.max(o,i),colStart:Math.min(r,a),colEnd:Math.max(r,a),numCols:Math.max(r,a)-Math.min(r,a)+1,numRows:Math.max(o,i)-Math.min(o,i)+1}}function O(e){return String(e+1)}function v(e){let t="";for(;e>=0;)t=String.fromCharCode(e%26+97)+t,e=Math.floor(e/26)-1;return t.toUpperCase()}function S(e){if(!e.ranges||1!==e.ranges.length||!e.cell)return!1;let t=e.ranges[0];if(void 0===t)return!1;let n=e.cell;return 1===t.width&&1===t.height&&t.col===n.col&&t.row===n.row}function y(e){return!!e.cell&&0===e.cols.length&&0===e.rows.length&&(0===e.ranges.length||S(e))}function b(e){return 0===e.cols.length&&0===e.rows.length&&!S(e)}function w(e){return e.cols.length>0&&0===e.rows.length&&(0===e.ranges.length||S(e))}function x(e){return e.rows.length>0&&0===e.cols.length&&(0===e.ranges.length||S(e))}function P(e){if(!e)return{type:"empty",text:"Empty selection",label:""};if(y(e)){let{col:t,row:n}=e.cell,r="".concat(v(t)).concat(O(n));return{text:"".concat(r," (Cell with col ").concat(t," row ").concat(n," has been selected)"),label:r}}if(b(e)&&e.rect){let{colStart:t,rowStart:n,colEnd:r,rowEnd:o}=e.rect,a="".concat(v(t)).concat(O(n)),i="".concat(v(r-1)).concat(O(o-1));return{type:"range",text:"".concat(a,":").concat(i," (Cells from ").concat(a," to ").concat(i," have been selected)"),label:"".concat(a,":").concat(i),rect:e.rect}}if(w(e)&&e.rect){let{colStart:t,colEnd:n}=e.rect,r=v(t),o=v(n);return{type:"col",text:"".concat(r,":").concat(o," (Cols ").concat(t+1,"-").concat(n+1," have been selected)"),label:"".concat(r,":").concat(o),rect:e.rect}}if(x(e)&&e.rect){let{rowStart:t,rowEnd:n}=e.rect,r=O(t),o=O(n);return{type:"row",text:"".concat(r,":").concat(o," (Rows ").concat(t+1,"-").concat(n+1," have been selected)"),label:"".concat(r,":").concat(o),rect:e.rect}}return{type:"empty",text:"Empty selection",label:""}}class C{eq(e){return JSON.stringify(this)===JSON.stringify(e)}toJSON(){return{type:"grid",...this}}setCell(e){var t;let n=[{col:e.col,row:e.row,width:1,height:1}].concat((null!=(t=this.ranges)?t:[]).slice(1));return new C(this.sheet,e,n,this.cols,this.rows)}get editingCell(){return this.cell?{sheet:this.sheet,...this.cell}:null}get cellLabel(){return this.cell?"".concat(v(this.cell.col)).concat(O(this.cell.row)):""}get rect(){if(w(this)&&1===this.cols.length&&void 0!==this.cols[0]){let[e,t]=this.cols[0];return{type:"col",colStart:e,colEnd:t-1,rowStart:0,rowEnd:1024,numCols:t-e,numRows:0}}if(x(this)&&1===this.rows.length&&void 0!==this.rows[0]){let[e,t]=this.rows[0];return{type:"row",colStart:0,colEnd:64,rowStart:e,rowEnd:t-1,numCols:0,numRows:t-e}}if(b(this)&&1===this.ranges.length&&void 0!==this.ranges[0]){let e=this.ranges[0];return{type:"range",colStart:e.col,colEnd:e.col+e.width-1,rowStart:e.row,rowEnd:e.row+e.height-1,numCols:e.width,numRows:e.height}}return y(this)?{type:"cell",colStart:this.cell.col,colEnd:this.cell.col,rowStart:this.cell.row,rowEnd:this.cell.row,numCols:1,numRows:1}:null}constructor(e,n={col:0,row:0},r=[],o=[],a=[]){(0,t._)(this,"sheet",void 0),(0,t._)(this,"cell",void 0),(0,t._)(this,"ranges",void 0),(0,t._)(this,"cols",void 0),(0,t._)(this,"rows",void 0),this.sheet=e,this.cell=n,this.ranges=r,this.cols=o,this.rows=a}}let E=c.default.createContext(void 0),k=e=>{let{id:t,initialState:r={},children:s,content:f,readOnly:h=!1}=e,{t:m}=(0,u.useTranslation)("files");((e,t,n,r,o)=>{c.default.useRef(e).current=e;let a=c.default.useRef(void 0);return c.default.useEffect(function(){let i;if(void 0===n)return;let l=a.current;if(!l||l.id!==e)return null==l||l.destroy(),a.current=l=A.create(e,t),l.initCalcEngine({content:n,readOnly:r}).then(e=>{e&&o&&e.onCells(o).then(e=>i=e).catch(console.error)}).catch(console.error),()=>{null==i||i()}},[e,n]),c.default.useEffect(function(){let e=a.current;e&&e.initCalcEngine({content:n,readOnly:r,force:!0}).catch(console.error)},[r]),c.default.useEffect(function(){return()=>{a.current=void 0}},[])})(t,r,f,h);let g=(0,l.getEditorView)(),O=g.useState(e=>e.nodes[t]),v=g.getModel(t);return O&&void 0!==f&&void 0!==v?(0,n.jsx)(E.Provider,{value:t,children:(0,n.jsxs)(a.ErrorBoundary,{fallbackRender:()=>(0,n.jsx)(d.FileError,{message:m("spreadsheet-open-error.message","The file can't be opened right now. The file format is invalid.")}),children:[s,(0,n.jsx)(p,{})]})}):(0,n.jsx)(o.DelayedRender,{children:(0,n.jsx)("div",{className:"flex w-full h-full justify-center items-center",children:(0,n.jsx)(i.Spinner,{size:"sm"})})})},Q={type:"sheet",highlights:[],activeSheet:0,selection:new C(0),sheets:[],editingCell:{sheet:0,col:0,row:0},error:null},R={newSheet:function(e,t){let n=[...e.sheets];n[t.index]={name:t.name,rowCount:256,colCount:26},e.setNodeProps({sheets:n})},deleteSheet:function(e,t){let n=[...e.sheets];n.splice(t.sheet,1),e.setNodeProps({sheets:n})},renameSheet:function(e,t){let n=[...e.sheets],r=n[t.index];r&&(n[t.index]={...r,name:t.new_value},e.setNodeProps({sheets:n}))},setCellValue:async function(e,t){let n=[...e.sheets];return e.calcEngine.getSheetProperties().then(r=>{let o=r[t.sheet];if(!o)return;let{rowCount:a,colCount:i}=o;n[t.sheet]={...o,rowCount:a,colCount:i},e.setNodeProps({sheets:n})}).catch(console.error)},insertColumn:function(e,t){let n=[...e.sheets],r=n[t.sheet];r&&(n[t.sheet]={...r,colCount:r.colCount+1},e.setNodeProps({sheets:n}))},deleteColumn:function(e,t){let n=[...e.sheets],r=n[t.sheet];r&&(n[t.sheet]={...r,colCount:r.colCount-1},e.setNodeProps({sheets:n}))},insertRow:function(e,t){let n=[...e.sheets],r=n[t.sheet];r&&(n[t.sheet]={...r,rowCount:r.rowCount+1},e.setNodeProps({sheets:n}))},deleteRow:function(e,t){let n=[...e.sheets],r=n[t.sheet];r&&(n[t.sheet]={...r,rowCount:r.rowCount-1},e.setNodeProps({sheets:n}))}};class A extends l.EditorStateModel{static create(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new A(e);return n.setNodeProps({...Q,...t,id:e}),n}get name(){return this.node.name}get activeSheet(){return this.node.activeSheet}get sheets(){var e,t;return null!=(t=null==(e=this.node)?void 0:e.sheets)?t:[]}get highlights(){return this.node.highlights}get editingCell(){return this.node.editingCell}get selection(){return this.node.selection}get error(){return this.node.error}get calcEngine(){let e=A.engines.get(this.id);if(!e)throw Error("SpreadsheetModel: No engine found for id ".concat(this.id));return e}async initCalcEngine(t){let{content:n,readOnly:r,force:o=!1}=t;if(!o&&this.calcEngine)return;let a=this.node.name||"Workbook",{CalcEngine:i}=await e.A(943812),{XLSXReader:l}=await e.A(620020),c=r?l.fromXLSX(n):null===n?i.initModel(a):i.fromXLSX(n);return await c.then(async e=>{A.engines.set(this.id,e);let t=await e.getSheetProperties();return this.setNodeProps({name:a,sheets:t}),e.onDiffs(s.proxy(e=>{for(let t of e){let e=R[t.type];null==e||e(this,t)}})).then(e=>this.dispose.push(e)).catch(console.error),e}).catch(e=>{e instanceof Error&&this.setNodeProps({error:e})}),this.calcEngine}destroy(){for(let e of(super.destroy(),A.engines.delete(this.id),this.dispose))e();this.dispose=[]}setNodeProps(e){e=function(e,t){if(t.sheets){var n;let r=t.sheets,o=null!=(n=t.activeSheet)?n:e.activeSheet,a=Math.max(0,Math.min(o,r.length-1));if(a!==o)return{...t,activeSheet:a}}return t}(this.node,e),super.setNodeProps({...e,type:"sheet",id:this.id})}async createSheet(e){return this.calcEngine.createSheet(e).catch(console.error)}async deleteSheet(e){return this.calcEngine.deleteSheet(e).catch(console.error)}async duplicateSheet(e){let t=this.sheets[e];if(!t)return;let n=function(e,t){var n;let{stem:r}=null==(n=N.exec(t))?void 0:n.groups,o=t=>e.includes(t);if(!o(t))return t;for(let e=2;;e++){let t="".concat(r," (").concat(e,")");if(!o(t))return t}}(this.sheets.map(e=>e.name),t.name),r={rowStart:0,rowEnd:t.rowCount,colStart:0,colEnd:t.colCount};return this.createSheet(n).then(t=>{if(t)return this.calcEngine.getCellsInRange(e,r).then(e=>{let n=e.map(e=>e.map(e=>e.serialized));this.calcEngine.setCellsInRange(t.sheetId,0,0,n).catch(console.error)}).catch(console.error),t})}async copySheet(e,t){let n=this.sheets[e];if(!n)return;let{rowCount:o,colCount:a}=n;return this.calcEngine.getCellsInRange(e,{rowStart:0,rowEnd:o,colStart:0,colEnd:a}).then(e=>{let n=(0,r.arrayToTable)(e.map(e=>e.map(e=>e.value)));(0,r.copyTableToClipboard)(n,t)}).catch(console.error)}async delimitSheet(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"csv",n=this.sheets[e];if(!n)return;let{rowCount:o,colCount:a}=n;return this.calcEngine.getCellsInRange(e,{rowStart:0,rowEnd:o,colStart:0,colEnd:a}).then(e=>{let n=(0,r.arrayToTable)(e.map(e=>e.map(e=>e.value)));return(0,r.delimitTable)(n,t)}).catch(console.error)}async renameSheet(e,t){return this.calcEngine.renameSheet(e,t).catch(console.error)}async insertRows(e,t,n){return this.calcEngine.insertRows(e,t,n).catch(console.error)}async insertCols(e,t,n){return this.calcEngine.insertCols(e,t,n).catch(console.error)}async deleteRows(e,t,n){return this.calcEngine.deleteRows(e,t,n).catch(console.error)}async deleteCols(e,t,n){return this.calcEngine.deleteCols(e,t,n).catch(console.error)}async clearCellsInRange(e,t){return this.calcEngine.clearCellsInRange(e,t).catch(console.error)}async setCellsInRange(e,t,n,r){return this.calcEngine.setCellsInRange(e,t,n,r).catch(console.error)}async copyCellsInRange(e,t){return this.calcEngine.getCellsInRange(e,t).then(e=>{let t=(0,r.arrayToTable)(e.map(e=>e.map(e=>e.value)));(0,r.copyTableToClipboard)(t)}).catch(console.error)}constructor(e){super(e),(0,t._)(this,"id",void 0),(0,t._)(this,"gridRefs",void 0),(0,t._)(this,"editor",void 0),(0,t._)(this,"dispose",void 0),this.id=e,this.gridRefs={},this.dispose=[]}}function T(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=(0,l.getEditorView)(),n=c.default.useContext(E)||t.state.activeId;if(!n){if(e)throw Error("useSpreadsheet: An id must be provided or the activeId must be set.");return}t.useState(e=>e.nodes[n]);let r=t.findById(A,n);if(!r){if(e)throw Error('Spreadsheet "'.concat(n,'" not found.'));return}return r}(0,t._)(A,"type","sheet"),(0,t._)(A,"engines",new Map),l.EditorStateModel.typeId(A.type,A);let N=RegExp("^(?<stem>.*?)(?:\\s\\((?<suffix>\\d+)\\))?$")},701856,728243,e=>{"use strict";function t(e){return 1===e.length?e.toUpperCase().charCodeAt(0)-65:e.split("").reduce((e,t)=>26*e+(t.toUpperCase().charCodeAt(0)-64),0)-1}function n(e){return Number(e)-1}function r(e){return String(e+1)}function o(e){let t="";for(;e>=0;)t=String.fromCharCode(e%26+97)+t,e=Math.floor(e/26)-1;return t.toUpperCase()}e.s(["addressToRange",()=>p,"colIndexToLabel",()=>o,"rowIndexToLabel",()=>r],701856);let a="(".concat("[".concat("A-Za-zÀ-ʯ","0-9_]+"),"|").concat("'(((?!').|'')*)'",")!"),i="'((?:(?!').|'')*)'",l="(".concat("[A-Za-z0-9_À-ʯ]+","|").concat(i,")"),s="(?![A-Za-z0-9_À-ʯ])";"(".concat(a,")?\\").concat("$","?[A-Za-z]+\\").concat("$","?[0-9]+"),new RegExp("".concat(i));let c=new RegExp("(".concat(l,"!)?((\\").concat("$",")?([A-Za-z]+)(\\").concat("$",")?([0-9]+))").concat(s)),u=new RegExp("(".concat(l,"!)?((\\").concat("$",")?([A-Za-z]+)(\\").concat("$",")?([0-9]+))").concat(":","((\\").concat("$",")?([A-Za-z]+)(\\").concat("$",")?([0-9]+))").concat(s)),d=new RegExp("(".concat(l,"!)?((\\").concat("$",")?([A-Za-z]+)").concat(":","(\\").concat("$",")?([A-Za-z]+))").concat(s)),f=new RegExp("(".concat(l,"!)?((\\").concat("$",")?([0-9]+)").concat(":","(\\").concat("$",")?([0-9]+))").concat(s)),p=e=>{let r;if(r=d.exec(e)){let[e,n,o,a=o,i,l,s,c,u]=r;if(void 0===s||void 0===u)return;let d=t(s),f=t(u);return{type:"col",anchor:[Math.min(d,f),Number.MAX_SAFE_INTEGER],head:[Math.max(d,f),Number.MAX_SAFE_INTEGER],absolute:"$"==l&&"$"==c,sheetName:a}}if(r=f.exec(e)){let[e,t,o,a=o,i,l,s,c,u]=r;if(void 0===s||void 0===u)return;let d=n(s),f=n(u);return{type:"row",anchor:[Number.MAX_SAFE_INTEGER,Math.min(d,f)],head:[Number.MAX_SAFE_INTEGER,Math.max(d,f)],absolute:"$"==l&&"$"==c,sheetName:a}}if(r=u.exec(e)){let[e,o,a,i=a,l,s,c,u,d,f,p,h,m,g]=r;if(void 0===c||void 0===h||void 0===d||void 0===g)return;let O=t(c),v=n(d),S=t(h),y=n(g);return{type:"range",anchor:[Math.min(O,S),Math.min(v,y)],head:[Math.max(O,S),Math.max(v,y)],absoluteColA:"$"==s,absoluteRowA:"$"==u,absoluteColB:"$"==p,absoluteRowB:"$"==m,sheetName:i}}if(r=c.exec(e)){let[e,o,a,i=a,l,s,c,u,d]=r;if(void 0===c||void 0===d)return;let f=t(c),p=n(d);return{type:"cell",anchor:[f,p],head:[f,p],absoluteCol:"$"==s,absoluteRow:"$"==u,sheetName:i}}};e.s(["cellHighlights",()=>x,"cellHighlightsFacet",()=>y,"cellReferencesFacet",()=>S],728243);var h=e.i(868275),m=e.i(650218),g=e.i(334283);let O=["#3b82f6","#ef4444","#a855f7","#16a34a","#db2777","#f97316","#14b8a6"],v=m.Facet.define({combine:e=>e.length&&e[0]?e[0]:O});new m.Compartment;let S=m.Facet.define({combine:e=>e.flat().sort((e,t)=>e.from-t.from)}),y=m.Facet.define({combine:e=>e.flat().sort((e,t)=>e.from-t.from)}),b=y.compute([S,v],e=>{let t=e.facet(S),n=e.facet(v),r=new Map,o=[];return t.forEach(e=>{var t;let{selection:a}=e,i=a.rangeId,l=null!=(t=r.get(i))?t:n[r.size%n.length];l&&(r.set(i,l),o.push({...e,color:l,range:a.rect}))}),o}),w=g.ViewPlugin.fromClass(class{update(e){(e.docChanged||e.state.facet(y)!==e.startState.facet(y))&&(this.decorations=this.computeDecos(e.view))}computeDecos(e){let t=new m.RangeSetBuilder;return e.state.facet(y).forEach(e=>{let{color:n,from:r,to:o}=e;t.add(r,o,g.Decoration.mark({class:"cm-cell-reference",attributes:{style:"color: ".concat(n)}}))}),t.finish()}constructor(e){(0,h._)(this,"decorations",void 0),this.decorations=this.computeDecos(e)}},{decorations:e=>e.decorations}),x=[b,m.Prec.highest(w)]},406845,517166,e=>{"use strict";e.s(["cellModeKeymapExt",()=>m,"handlePointerDown",()=>d],406845);var t=e.i(650218),n=e.i(334283),r=e.i(476238);e.s(["DEFAULT_SPREADSHEET_STATE",()=>o,"sheetStateCompartment",()=>l,"sheetViewCompartment",()=>s,"spreadsheetState",()=>a,"spreadsheetView",()=>i,"updateSpreadsheetState",()=>c],517166);let o={cell:{sheet:0,col:0,row:0},sheetProperties:{0:{name:"Sheet1",rowCount:256,colCount:26}}},a=t.Facet.define({combine:e=>{var t;return null!=(t=e[0])?t:o}}),i=t.Facet.define({combine:e=>{var t;return null!=(t=e[0])?t:{cellFromPointer:()=>void 0,scrollToCell:()=>{}}}}),l=new t.Compartment,s=new t.Compartment;function c(e){return function(t){let{state:n,dispatch:r}=t,o=n.facet(a);return r(n.update({effects:[l.reconfigure(a.of({...o,...e}))]})),!0}}function u(e,n){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=e.state.field(r.cellModeState,!1),s=e.state.facet(a);if(!l||l.mode!==r.CellMode.Point&&!(0,r.canPoint)(e.state))return!1;let{anchor:c,head:u=c}=l.mode===r.CellMode.Point?l.cellSelection:{anchor:[s.cell.col,s.cell.row]};c=o?c:n,u=n;let d=new r.CellSelection(c,u).address,{from:f,to:p}=l.mode===r.CellMode.Point?l.range:e.state.selection.main;return e.state.facet(i).scrollToCell({sheet:s.cell.sheet,col:u[0],row:u[1]}),e.dispatch({changes:{from:f,to:p,insert:d},selection:t.EditorSelection.range(f+d.length,f+d.length),effects:[r.setCellSelection.of({range:{from:f,to:f+d.length},cellSelection:{sheet:s.cell.sheet,anchor:c,head:u},mode:r.CellMode.Point})]}),!0}function d(e,t){if(!t.hasFocus||t.dom.contains(e.target)||e.ctrlKey||e.metaKey)return!1;let n=t.state.field(r.cellModeState,!1);if(!n||n.mode!==r.CellMode.Point&&!(0,r.canPoint)(t.state))return!1;e.preventDefault(),e.stopImmediatePropagation();let o=document.querySelector("#portal");function l(){o.style.pointerEvents="",window.removeEventListener("pointerup",l),window.removeEventListener("dragstart",l),window.removeEventListener("pointermove",s)}function s(e){window.requestAnimationFrame(()=>{let n=t.state.field(r.cellModeState,!1);if(!n||n.mode!==r.CellMode.Point&&!(0,r.canPoint)(t.state))return!1;let o=t.state.facet(a),l=t.state.facet(i).cellFromPointer(e);if(!l)return!1;let s=n.mode===r.CellMode.Point?n.cellSelection.head:[o.cell.col,o.cell.row];if(l.col===s[0]&&l.row===s[1])return!1;let c=n.mode===r.CellMode.Point&&l.sheet===n.cellSelection.sheet;u(t,[l.col,l.row],c)})}if(window.addEventListener("pointerup",l),window.addEventListener("dragstart",l),window.addEventListener("pointermove",s),t.dom.contains(e.target))return!1;let c=t.state.facet(i).cellFromPointer(e);if(!c)return!1;e.preventDefault(),e.stopImmediatePropagation();let d=e.shiftKey&&n.mode===r.CellMode.Point&&c.sheet===n.cellSelection.sheet;u(t,[c.col,c.row],d),o.style.pointerEvents="none"}function f(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return o=>{let i=o.state.field(r.cellModeState,!1),l=o.state.facet(a);if(!i)return!1;if(i.mode===r.CellMode.Point){let r;if(i.cellSelection){let{anchor:e,head:t=e}=i.cellSelection;r=n?t:e}else r=[l.cell.col,l.cell.row];let a=l.sheetProperties[l.cell.sheet];if(!a)return!1;let s=a["horiz"===e?"colCount":"rowCount"];return void 0!==r[0]&&void 0!==r[1]&&u(o,["horiz"===e?Math.min(Math.max(r[0]+t,0),s):r[0],"horiz"===e?r[1]:Math.min(Math.max(r[1]+t,0),s)],n)}if((0,r.canPoint)(o.state)&&o.state.selection.main.empty){let n=l.cell.col,r=l.cell.row,a=l.sheetProperties[l.cell.sheet];if(!a)return!1;let i="horiz"===e?n+t:n,s="horiz"===e?r:r+t;return u(o,[i=Math.min(Math.max(i,0),a.colCount),s=Math.min(Math.max(s,0),a.rowCount)],!1)}return!1}}function p(e){return t=>{let n=t.state.field(r.cellModeState,!1),o=t.state.facet(a);if(!n||n.mode!==r.CellMode.Point)return!1;let i="horiz"===e?-1:o.cell.col,l="horiz"===e?o.cell.row:-1;if(n.cellSelection){let{anchor:t,head:r=t}=n.cellSelection;"horiz"===e?l=r[1]:i=r[0]}return u(t,[i,l],!0)}}let h=[{key:"ArrowDown",run:f("vert",1),shift:f("vert",1,!0)},{key:"ArrowUp",run:f("vert",-1),shift:f("vert",-1,!0)},{key:"ArrowRight",run:f("horiz",1),shift:f("horiz",1,!0)},{key:"ArrowLeft",run:f("horiz",-1),shift:f("horiz",-1,!0)},{key:"Ctrl-Space",run:p("vert"),preventDefault:!0},{key:"Shift-Space",run:p("horiz"),preventDefault:!0},{key:"Mod-e",run:r.toggleEditMode,preventDefault:!0},{key:"F2",run:r.toggleEditMode,preventDefault:!0}],m=t.Prec.high(n.keymap.computeN([],()=>[h]))},476238,e=>{"use strict";e.s(["CellMode",()=>p,"CellSelection",()=>f,"canPoint",()=>v,"capturePointerEventToEditorView",()=>y,"cellMode",()=>c,"cellModeState",()=>m,"setCellSelection",()=>u,"toggleEditMode",()=>w]);var t=e.i(868275),n=e.i(255791),r=e.i(650218),o=e.i(334283),a=e.i(701856),i=e.i(728243),l=e.i(406845);let s=new Set(["CellToken","RangeToken","RowRangeToken","ColRangeToken","ReferenceItem","Reference"]);function c(){return[m,l.cellModeKeymapExt,r.Prec.highest(S)]}let u=r.StateEffect.define(),d=e=>-1===e||e===Number.MAX_SAFE_INTEGER||e===1/0;class f{get isColSelection(){let[e,t]=this.anchor,[n,r]=this.head;return d(t)||d(r)}get isRowSelection(){let[e,t]=this.anchor,[n,r]=this.head;return d(e)||d(n)}get isAllSelection(){return this.isColSelection&&this.isRowSelection}get isCellSelection(){let[e,t]=this.anchor,[n,r]=this.head;return!this.isColSelection&&!this.isRowSelection&&e===n&&t===r}get isRangeSelection(){let[e,t]=this.anchor,[n,r]=this.head;return!this.isCellSelection&&e!==n||t!==r}eq(e){return e.anchor[0]===this.anchor[0]&&e.anchor[1]===this.anchor[1]&&e.head[0]===this.head[0]&&e.head[1]===this.head[1]}get address(){let[e,t]=this.anchor,[n,r]=this.head;return this.isRowSelection?"".concat((0,a.rowIndexToLabel)(t),":").concat((0,a.rowIndexToLabel)(r)):this.isColSelection?"".concat((0,a.colIndexToLabel)(e),":").concat((0,a.colIndexToLabel)(n)):this.isCellSelection?"".concat((0,a.colIndexToLabel)(e)).concat((0,a.rowIndexToLabel)(t)):this.isRangeSelection?"".concat((0,a.colIndexToLabel)(e)).concat((0,a.rowIndexToLabel)(t),":").concat((0,a.colIndexToLabel)(n)).concat((0,a.rowIndexToLabel)(r)):""}get rect(){let[e,t]=this.anchor,[n,r]=this.head;return this.isAllSelection?{x:0,y:0,width:Number.MAX_SAFE_INTEGER,height:Number.MAX_SAFE_INTEGER}:this.isColSelection?{x:Math.min(e,n),y:0,width:Math.abs(n-e)+1,height:Number.MAX_SAFE_INTEGER}:this.isRowSelection?{x:0,y:Math.min(t,r),width:Number.MAX_SAFE_INTEGER,height:Math.abs(r-t)+1}:{x:Math.min(e,n),y:Math.min(t,r),width:Math.abs(n-e)+1,height:Math.abs(r-t)+1}}get rangeId(){return JSON.stringify(this.rect)}get reversed(){return new f(this.head,this.anchor)}eqRange(e){return this.rangeId===e.rangeId}constructor(e,n=e){(0,t._)(this,"anchor",void 0),(0,t._)(this,"head",void 0),this.anchor=e,this.head=n}}var p=function(e){return e.Ready="Ready",e.Enter="Enter",e.Point="Point",e.Edit="Edit",e}({});let h={mode:"Enter"},m=r.StateField.define({create:()=>({mode:"Enter"}),update(e,t){for(let e of t.effects)if(e.is(u))return e.value;return(t.docChanged||t.selection)&&("Enter"===e.mode||"Point"===e.mode)?b(t.state):e},provide:e=>i.cellReferencesFacet.from(e,e=>{if("Point"!==e.mode)return[];let{anchor:t,head:n}=e.cellSelection,r=new f(t,n);return[{from:e.range.from,to:e.range.to,selection:r}]})}),g=o.Decoration.widget({widget:new class extends o.WidgetType{toDOM(){let e=document.createElement("span");return e.textContent="⎵",e.className="cm-cell-range-marker",e}ignoreEvent(){return!1}},side:1}),O=o.Decoration.mark({class:"cm-underline"});function v(e){let t=e.field(m,!1);return!!t&&"Enter"===t.mode&&e.selection.main.empty&&function(e,t){let r=(0,n.syntaxTree)(e).resolve(t,-1);for(;r;){let e=r.name;if("TextToken"===e||"Number"===e||"BoolToken"===e||"ErrorToken"===e)break;if("CellToken"===e||"RowRangeToken"===e||"ColRangeToken"===e||"RangeToken"===e||"ReferenceItem"===e||"Reference"===e||"ArithOp"===e||"ArgList"===e||"Separator"===e||"FormulaWithEq"===e||"Formula"===e)return!0;r=r.parent}return!1}(e,e.selection.main.head)}let S=o.ViewPlugin.fromClass(class{update(e){this.decorations=this.buildDeco(e.view)}buildDeco(e){let t=e.state,n=e.state.field(m,!1),o=new r.RangeSetBuilder;if(!n||!e.hasFocus)return o.finish();if("Point"===n.mode&&o.add(n.range.from,n.range.to,O),v(e.state)){let e=t.selection.main.to;o.add(e,e,g)}return o.finish()}constructor(e){(0,t._)(this,"view",void 0),(0,t._)(this,"decorations",void 0),this.view=e,this.decorations=this.buildDeco(e)}},{decorations:e=>e.decorations});function y(e,t){let n=e.state.field(m,!1);return!(!n||!e.hasFocus||e.dom.contains(t.target))&&("Point"===n.mode||v(e.state))}function b(e){let t=e.selection.main;if(!t.empty)return h;let r=function(e,t){let r=r=>{let o,a=(0,n.syntaxTree)(e).resolve(t,r);for(;a;)s.has(a.name)&&(o=a),a=a.parent;return o};return r(-1)||r(1)}(e,t.head);if(!r)return h;let o=e.sliceDoc(r.from,r.to),i=(0,a.addressToRange)(o);return i?{mode:"Point",range:r,cellSelection:{sheet:0,anchor:[...i.anchor],head:[...i.head]}}:h}function w(e){let t=e.state.field(m,!1);if(!t)return!1;switch(t.mode){case"Ready":case"Edit":{let t=b(e.state);return e.dispatch({effects:u.of(t)}),!0}case"Point":case"Enter":return e.dispatch({effects:u.of({mode:"Edit"})}),!0;default:return!1}}},162284,e=>{"use strict";e.s(["cursorDocEnd",()=>el,"defaultKeymap",()=>eE,"history",()=>g,"historyKeymap",()=>A,"selectAll",()=>eu]);var t=e.i(650218),n=e.i(334283),r=e.i(255791),o=e.i(725915);function a(e,t){return n=>{let{state:r,dispatch:o}=n;if(r.readOnly)return!1;let a=e(t,r);return!!a&&(o(r.update(a)),!0)}}let i=a(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.selection.ranges,r=[],o=-1;for(let{from:e,to:a}of n){let n=r.length,i=1e9,l=c(t,e).line;if(l){for(let n=e;n<=a;){let s=t.doc.lineAt(n);if(s.from>o&&(e==a||a>s.from)){o=s.from;let e=/^\s*/.exec(s.text)[0].length,t=e==s.length,n=s.text.slice(e,e+l.length)==l?e:-1;e<s.text.length&&e<i&&(i=e),r.push({line:s,comment:n,token:l,indent:e,empty:t,single:!1})}n=s.to+1}if(i<1e9)for(let e=n;e<r.length;e++)r[e].indent<r[e].line.text.length&&(r[e].indent=i);r.length==n+1&&(r[n].single=!0)}}if(2!=e&&r.some(e=>e.comment<0&&(!e.empty||e.single))){let e=[];for(let{line:t,token:n,indent:o,empty:a,single:i}of r)(i||!a)&&e.push({from:t.from+o,insert:n+" "});let n=t.changes(e);return{changes:n,selection:t.selection.map(n,1)}}if(1!=e&&r.some(e=>e.comment>=0)){let e=[];for(let{line:t,comment:n,token:o}of r)if(n>=0){let r=t.from+n,a=r+o.length;" "==t.text[a-t.from]&&a++,e.push({from:r,to:a})}return{changes:e}}return null},0),l=a(u,0),s=a((e,t)=>u(e,t,function(e){let t=[];for(let n of e.selection.ranges){let r=e.doc.lineAt(n.from),o=n.to<=r.to?r:e.doc.lineAt(n.to);o.from>r.from&&o.from==n.to&&(o=n.to==r.to+1?r:e.doc.lineAt(n.to-1));let a=t.length-1;a>=0&&t[a].to>r.from?t[a].to=o.to:t.push({from:r.from+/^\s*/.exec(r.text)[0].length,to:o.to})}return t}(t)),0);function c(e,t){let n=e.languageDataAt("commentTokens",t,1);return n.length?n[0]:{}}function u(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.selection.ranges,r=n.map(e=>c(t,e.from).block);if(!r.every(e=>e))return null;let o=n.map((e,n)=>(function(e,t,n,r){let o,a,{open:i,close:l}=t,s=e.sliceDoc(n-50,n),c=e.sliceDoc(r,r+50),u=/\s*$/.exec(s)[0].length,d=/^\s*/.exec(c)[0].length,f=s.length-u;if(s.slice(f-i.length,f)==i&&c.slice(d,d+l.length)==l)return{open:{pos:n-u,margin:u&&1},close:{pos:r+d,margin:d&&1}};r-n<=100?o=a=e.sliceDoc(n,r):(o=e.sliceDoc(n,n+50),a=e.sliceDoc(r-50,r));let p=/^\s*/.exec(o)[0].length,h=/\s*$/.exec(a)[0].length,m=a.length-h-l.length;return o.slice(p,p+i.length)==i&&a.slice(m,m+l.length)==l?{open:{pos:n+p+i.length,margin:+!!/\s/.test(o.charAt(p+i.length))},close:{pos:r-h-l.length,margin:+!!/\s/.test(a.charAt(m-1))}}:null})(t,r[n],e.from,e.to));if(2!=e&&!o.every(e=>e))return{changes:t.changes(n.map((e,t)=>o[t]?[]:[{from:e.from,insert:r[t].open+" "},{from:e.to,insert:" "+r[t].close}]))};if(1!=e&&o.some(e=>e)){let e=[];for(let t=0,n;t<o.length;t++)if(n=o[t]){let o=r[t],{open:a,close:i}=n;e.push({from:a.pos-o.open.length,to:a.pos+a.margin},{from:i.pos-i.margin,to:i.pos+o.close.length})}return{changes:e}}return null}let d=t.Annotation.define(),f=t.Annotation.define(),p=t.Facet.define(),h=t.Facet.define({combine:e=>(0,t.combineConfig)(e,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(n,r)=>e(n,r)||t(n,r)})}),m=t.StateField.define({create:()=>R.empty,update(e,n){let r=n.state.facet(h),o=n.annotation(d);if(o){let t=w.fromTransaction(n,o.selection),a=o.side,i=0==a?e.undone:e.done;return i=t?x(i,i.length,r.minDepth,t):E(i,n.startState.selection),new R(0==a?o.rest:i,0==a?i:o.rest)}let a=n.annotation(f);if(("full"==a||"before"==a)&&(e=e.isolate()),!1===n.annotation(t.Transaction.addToHistory))return n.changes.empty?e:e.addMapping(n.changes.desc);let i=w.fromTransaction(n),l=n.annotation(t.Transaction.time),s=n.annotation(t.Transaction.userEvent);return i?e=e.addChanges(i,l,s,r,n):n.selection&&(e=e.addSelection(n.startState.selection,l,s,r.newGroupDelay)),("full"==a||"after"==a)&&(e=e.isolate()),e},toJSON:e=>({done:e.done.map(e=>e.toJSON()),undone:e.undone.map(e=>e.toJSON())}),fromJSON:e=>new R(e.done.map(w.fromJSON),e.undone.map(w.fromJSON))});function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[m,h.of(e),n.EditorView.domEventHandlers({beforeinput(e,t){let n="historyUndo"==e.inputType?v:"historyRedo"==e.inputType?S:null;return!!n&&(e.preventDefault(),n(t))}})]}function O(e,t){return function(n){let{state:r,dispatch:o}=n;if(!t&&r.readOnly)return!1;let a=r.field(m,!1);if(!a)return!1;let i=a.pop(e,r,t);return!!i&&(o(i),!0)}}let v=O(0,!1),S=O(1,!1),y=O(0,!0),b=O(1,!0);class w{setSelAfter(e){return new w(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,n;return{changes:null==(e=this.changes)?void 0:e.toJSON(),mapped:null==(t=this.mapped)?void 0:t.toJSON(),startSelection:null==(n=this.startSelection)?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map(e=>e.toJSON())}}static fromJSON(e){return new w(e.changes&&t.ChangeSet.fromJSON(e.changes),[],e.mapped&&t.ChangeDesc.fromJSON(e.mapped),e.startSelection&&t.EditorSelection.fromJSON(e.startSelection),e.selectionsAfter.map(t.EditorSelection.fromJSON))}static fromTransaction(e,t){let n=C;for(let t of e.startState.facet(p)){let r=t(e);r.length&&(n=n.concat(r))}return!n.length&&e.changes.empty?null:new w(e.changes.invert(e.startState.doc),n,void 0,t||e.startState.selection,C)}static selection(e){return new w(void 0,C,void 0,void 0,e)}constructor(e,t,n,r,o){this.changes=e,this.effects=t,this.mapped=n,this.startSelection=r,this.selectionsAfter=o}}function x(e,t,n,r){let o=e.slice(t+1>n+20?t-n-1:0,t);return o.push(r),o}function P(e,t){return e.length?t.length?e.concat(t):e:t}let C=[];function E(e,t){if(!e.length)return[w.selection([t])];{let n=e[e.length-1],r=n.selectionsAfter.slice(Math.max(0,n.selectionsAfter.length-200));return r.length&&r[r.length-1].eq(t)?e:(r.push(t),x(e,e.length-1,1e9,n.setSelAfter(r)))}}function k(e,n){if(!e.length)return e;let r=e.length,o=C;for(;r;){let a=function(e,n,r){let o=P(e.selectionsAfter.length?e.selectionsAfter.map(e=>e.map(n)):C,r);if(!e.changes)return w.selection(o);let a=e.changes.map(n),i=n.mapDesc(e.changes,!0),l=e.mapped?e.mapped.composeDesc(i):i;return new w(a,t.StateEffect.mapEffects(e.effects,n),l,e.startSelection.map(i),o)}(e[r-1],n,o);if(a.changes&&!a.changes.empty||a.effects.length){let t=e.slice(0,r);return t[r-1]=a,t}n=a.mapped,r--,o=a.selectionsAfter}return o.length?[w.selection(o)]:C}let Q=/^(input\.type|delete)($|\.)/;class R{isolate(){return this.prevTime?new R(this.done,this.undone):this}addChanges(e,n,r,o,a){var i,l;let s,c,u=this.done,d=u[u.length-1];return new R(u=d&&d.changes&&!d.changes.empty&&e.changes&&(!r||Q.test(r))&&(!d.selectionsAfter.length&&n-this.prevTime<o.newGroupDelay&&o.joinToEvent(a,(i=d.changes,l=e.changes,s=[],c=!1,i.iterChangedRanges((e,t)=>s.push(e,t)),l.iterChangedRanges((e,t,n,r)=>{for(let e=0;e<s.length;){let t=s[e++],o=s[e++];r>=t&&n<=o&&(c=!0)}}),c))||"input.type.compose"==r)?x(u,u.length-1,o.minDepth,new w(e.changes.compose(d.changes),P(t.StateEffect.mapEffects(e.effects,d.changes),d.effects),d.mapped,d.startSelection,C)):x(u,u.length,o.minDepth,e),C,n,r)}addSelection(e,t,n,r){var o;let a=this.done.length?this.done[this.done.length-1].selectionsAfter:C;return a.length>0&&t-this.prevTime<r&&n==this.prevUserEvent&&n&&/^select($|\.)/.test(n)&&(o=a[a.length-1],o.ranges.length==e.ranges.length&&0===o.ranges.filter((t,n)=>t.empty!=e.ranges[n].empty).length)?this:new R(E(this.done,e),this.undone,t,n)}addMapping(e){return new R(k(this.done,e),k(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,n){let r=0==e?this.done:this.undone;if(0==r.length)return null;let o=r[r.length-1],a=o.selectionsAfter[0]||t.selection;if(n&&o.selectionsAfter.length){let n,i;return t.update({selection:o.selectionsAfter[o.selectionsAfter.length-1],annotations:d.of({side:e,rest:(n=r[r.length-1],(i=r.slice())[r.length-1]=n.setSelAfter(n.selectionsAfter.slice(0,n.selectionsAfter.length-1)),i),selection:a}),userEvent:0==e?"select.undo":"select.redo",scrollIntoView:!0})}{if(!o.changes)return null;let n=1==r.length?C:r.slice(0,r.length-1);return o.mapped&&(n=k(n,o.mapped)),t.update({changes:o.changes,selection:o.startSelection,effects:o.effects,annotations:d.of({side:e,rest:n,selection:a}),filter:!1,userEvent:0==e?"undo":"redo",scrollIntoView:!0})}}constructor(e,t,n=0,r){this.done=e,this.undone=t,this.prevTime=n,this.prevUserEvent=r}}R.empty=new R(C,C);let A=[{key:"Mod-z",run:v,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:S,preventDefault:!0},{linux:"Ctrl-Shift-z",run:S,preventDefault:!0},{key:"Mod-u",run:y,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:b,preventDefault:!0}];function T(e,n){return t.EditorSelection.create(e.ranges.map(n),e.mainIndex)}function N(e,t){return e.update({selection:t,scrollIntoView:!0,userEvent:"select"})}function W(e,t){let{state:n,dispatch:r}=e,o=T(n.selection,t);return!o.eq(n.selection,!0)&&(r(N(n,o)),!0)}function q(e,n){return t.EditorSelection.cursor(n?e.to:e.from)}function I(e,t){return W(e,n=>n.empty?e.moveByChar(n,t):q(n,t))}function M(e){return e.textDirectionAt(e.state.selection.main.head)==n.Direction.LTR}let X=e=>I(e,!M(e)),D=e=>I(e,M(e));function j(e,t){return W(e,n=>n.empty?e.moveByGroup(n,t):q(n,t))}function z(e,n,a){let i,l,s=(0,r.syntaxTree)(e).resolveInner(n.head),c=a?o.NodeProp.closedBy:o.NodeProp.openedBy;for(let t=n.head;;){let n=a?s.childAfter(t):s.childBefore(t);if(!n)break;!function(e,t,n){if(t.type.prop(n))return!0;let r=t.to-t.from;return r&&(r>2||/[^\s,.;:]/.test(e.sliceDoc(t.from,t.to)))||t.firstChild}(e,n,c)?t=a?n.to:n.from:s=n}return l=s.type.prop(c)&&(i=a?(0,r.matchBrackets)(e,s.from,1):(0,r.matchBrackets)(e,s.to,-1))&&i.matched?a?i.end.to:i.end.from:a?s.to:s.from,t.EditorSelection.cursor(l,a?-1:1)}function _(e,t){return W(e,n=>{if(!n.empty)return q(n,t);let r=e.moveVertically(n,t);return r.head!=n.head?r:e.moveToLineBoundary(n,t)})}"undefined"!=typeof Intl&&Intl.Segmenter;let B=e=>_(e,!1),V=e=>_(e,!0);function F(e){let t=e.scrollDOM.clientHeight<e.scrollDOM.scrollHeight-2,r=0,o=0,a;if(t){for(let t of e.state.facet(n.EditorView.scrollMargins)){let n=t(e);(null==n?void 0:n.top)&&(r=Math.max(null==n?void 0:n.top,r)),(null==n?void 0:n.bottom)&&(o=Math.max(null==n?void 0:n.bottom,o))}a=e.scrollDOM.clientHeight-r-o}else a=(e.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:r,marginBottom:o,selfScroll:t,height:Math.max(e.defaultLineHeight,a-5)}}function L(e,t){let r,o=F(e),{state:a}=e,i=T(a.selection,n=>n.empty?e.moveVertically(n,t,o.height):q(n,t));if(i.eq(a.selection))return!1;if(o.selfScroll){let t=e.coordsAtPos(a.selection.main.head),l=e.scrollDOM.getBoundingClientRect(),s=l.top+o.marginTop,c=l.bottom-o.marginBottom;t&&t.top>s&&t.bottom<c&&(r=n.EditorView.scrollIntoView(i.main.head,{y:"start",yMargin:t.top-s}))}return e.dispatch(N(a,i),{effects:r}),!0}let U=e=>L(e,!1),G=e=>L(e,!0);function Y(e,n,r){let o=e.lineBlockAt(n.head),a=e.moveToLineBoundary(n,r);if(a.head==n.head&&a.head!=(r?o.to:o.from)&&(a=e.moveToLineBoundary(n,r,!1)),!r&&a.head==o.from&&o.length){let r=/^\s*/.exec(e.state.sliceDoc(o.from,Math.min(o.from+100,o.to)))[0].length;r&&n.head!=o.from+r&&(a=t.EditorSelection.cursor(o.from+r))}return a}function Z(e,n){let r=T(e.state.selection,e=>{let r=n(e);return t.EditorSelection.range(e.anchor,r.head,r.goalColumn,r.bidiLevel||void 0)});return!r.eq(e.state.selection)&&(e.dispatch(N(e.state,r)),!0)}function $(e,t){return Z(e,n=>e.moveByChar(n,t))}let H=e=>$(e,!M(e)),J=e=>$(e,M(e));function K(e,t){return Z(e,n=>e.moveByGroup(n,t))}function ee(e,t){return Z(e,n=>e.moveVertically(n,t))}let et=e=>ee(e,!1),en=e=>ee(e,!0);function er(e,t){return Z(e,n=>e.moveVertically(n,t,F(e).height))}let eo=e=>er(e,!1),ea=e=>er(e,!0),ei=e=>{let{state:t,dispatch:n}=e;return n(N(t,{anchor:0})),!0},el=e=>{let{state:t,dispatch:n}=e;return n(N(t,{anchor:t.doc.length})),!0},es=e=>{let{state:t,dispatch:n}=e;return n(N(t,{anchor:t.selection.main.anchor,head:0})),!0},ec=e=>{let{state:t,dispatch:n}=e;return n(N(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0},eu=e=>{let{state:t,dispatch:n}=e;return n(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0};function ed(e,r){if(e.state.readOnly)return!1;let o="delete.selection",{state:a}=e,i=a.changeByRange(n=>{let{from:a,to:i}=n;if(a==i){let t=r(n);t<a?(o="delete.backward",t=ef(e,t,!1)):t>a&&(o="delete.forward",t=ef(e,t,!0)),a=Math.min(a,t),i=Math.max(i,t)}else a=ef(e,a,!1),i=ef(e,i,!0);return a==i?{range:n}:{changes:{from:a,to:i},range:t.EditorSelection.cursor(a,a<n.head?-1:1)}});return!i.changes.empty&&(e.dispatch(a.update(i,{scrollIntoView:!0,userEvent:o,effects:"delete.selection"==o?n.EditorView.announce.of(a.phrase("Selection deleted")):void 0})),!0)}function ef(e,t,r){if(e instanceof n.EditorView)for(let o of e.state.facet(n.EditorView.atomicRanges).map(t=>t(e)))o.between(t,t,(e,n)=>{e<t&&n>t&&(t=r?n:e)});return t}let ep=(e,n,o)=>ed(e,a=>{let i=a.from,{state:l}=e,s=l.doc.lineAt(i),c,u;if(o&&!n&&i>s.from&&i<s.from+200&&!/[^ \t]/.test(c=s.text.slice(0,i-s.from))){if("	"==c[c.length-1])return i-1;let e=(0,t.countColumn)(c,l.tabSize)%(0,r.getIndentUnit)(l)||(0,r.getIndentUnit)(l);for(let t=0;t<e&&" "==c[c.length-1-t];t++)i--;u=i}else(u=(0,t.findClusterBreak)(s.text,i-s.from,n,n)+s.from)==i&&s.number!=(n?l.doc.lines:1)?u+=n?1:-1:!n&&/[\ufe00-\ufe0f]/.test(s.text.slice(u-s.from,i-s.from))&&(u=(0,t.findClusterBreak)(s.text,u-s.from,!1,!1)+s.from);return u}),eh=e=>ep(e,!1,!0),em=e=>ep(e,!0,!1),eg=(e,n)=>ed(e,r=>{let o=r.head,{state:a}=e,i=a.doc.lineAt(o),l=a.charCategorizer(o);for(let e=null;;){if(o==(n?i.to:i.from)){o==r.head&&i.number!=(n?a.doc.lines:1)&&(o+=n?1:-1);break}let s=(0,t.findClusterBreak)(i.text,o-i.from,n)+i.from,c=i.text.slice(Math.min(o,s)-i.from,Math.max(o,s)-i.from),u=l(c);if(null!=e&&u!=e)break;(" "!=c||o!=r.head)&&(e=u),o=s}return o}),eO=e=>eg(e,!1);function ev(e){let t=[],n=-1;for(let r of e.selection.ranges){let o=e.doc.lineAt(r.from),a=e.doc.lineAt(r.to);if(r.empty||r.to!=a.from||(a=e.doc.lineAt(r.to-1)),n>=o.number){let e=t[t.length-1];e.to=a.to,e.ranges.push(r)}else t.push({from:o.from,to:a.to,ranges:[r]});n=a.number+1}return t}function eS(e,n,r){if(e.readOnly)return!1;let o=[],a=[];for(let n of ev(e)){if(r?n.to==e.doc.length:0==n.from)continue;let i=e.doc.lineAt(r?n.to+1:n.from-1),l=i.length+1;if(r)for(let r of(o.push({from:n.to,to:i.to},{from:n.from,insert:i.text+e.lineBreak}),n.ranges))a.push(t.EditorSelection.range(Math.min(e.doc.length,r.anchor+l),Math.min(e.doc.length,r.head+l)));else for(let r of(o.push({from:i.from,to:n.from},{from:n.to,insert:e.lineBreak+i.text}),n.ranges))a.push(t.EditorSelection.range(r.anchor-l,r.head-l))}return!!o.length&&(n(e.update({changes:o,scrollIntoView:!0,selection:t.EditorSelection.create(a,e.selection.mainIndex),userEvent:"move.line"})),!0)}function ey(e,t,n){if(e.readOnly)return!1;let r=[];for(let t of ev(e))n?r.push({from:t.from,insert:e.doc.slice(t.from,t.to)+e.lineBreak}):r.push({from:t.to,insert:e.lineBreak+e.doc.slice(t.from,t.to)});return t(e.update({changes:r,scrollIntoView:!0,userEvent:"input.copyline"})),!0}let eb=ex(!1),ew=ex(!0);function ex(e){return n=>{let{state:a,dispatch:i}=n;if(a.readOnly)return!1;let l=a.changeByRange(n=>{let{from:i,to:l}=n,s=a.doc.lineAt(i),c=!e&&i==l&&function(e,t){if(/\(\)|\[\]|\{\}/.test(e.sliceDoc(t-1,t+1)))return{from:t,to:t};let n=(0,r.syntaxTree)(e).resolveInner(t),a=n.childBefore(t),i=n.childAfter(t),l;return a&&i&&a.to<=t&&i.from>=t&&(l=a.type.prop(o.NodeProp.closedBy))&&l.indexOf(i.name)>-1&&e.doc.lineAt(a.to).from==e.doc.lineAt(i.from).from&&!/\S/.test(e.sliceDoc(a.to,i.from))?{from:a.to,to:i.from}:null}(a,i);e&&(i=l=(l<=s.to?s:a.doc.lineAt(l)).to);let u=new r.IndentContext(a,{simulateBreak:i,simulateDoubleBreak:!!c}),d=(0,r.getIndentation)(u,i);for(null==d&&(d=(0,t.countColumn)(/^\s*/.exec(a.doc.lineAt(i).text)[0],a.tabSize));l<s.to&&/\s/.test(s.text[l-s.from]);)l++;c?{from:i,to:l}=c:i>s.from&&i<s.from+100&&!/\S/.test(s.text.slice(0,i))&&(i=s.from);let f=["",(0,r.indentString)(a,d)];return c&&f.push((0,r.indentString)(a,u.lineIndent(s.from,-1))),{changes:{from:i,to:l,insert:t.Text.of(f)},range:t.EditorSelection.cursor(i+1+f[1].length)}});return i(a.update(l,{scrollIntoView:!0,userEvent:"input"})),!0}}function eP(e,n){let r=-1;return e.changeByRange(o=>{let a=[];for(let t=o.from;t<=o.to;){let i=e.doc.lineAt(t);i.number>r&&(o.empty||o.to>i.from)&&(n(i,a,o),r=i.number),t=i.to+1}let i=e.changes(a);return{changes:a,range:t.EditorSelection.range(i.mapPos(o.anchor,1),i.mapPos(o.head,1))}})}let eC=[{key:"Ctrl-b",run:X,shift:H,preventDefault:!0},{key:"Ctrl-f",run:D,shift:J},{key:"Ctrl-p",run:B,shift:et},{key:"Ctrl-n",run:V,shift:en},{key:"Ctrl-a",run:e=>W(e,n=>t.EditorSelection.cursor(e.lineBlockAt(n.head).from,1)),shift:e=>Z(e,n=>t.EditorSelection.cursor(e.lineBlockAt(n.head).from))},{key:"Ctrl-e",run:e=>W(e,n=>t.EditorSelection.cursor(e.lineBlockAt(n.head).to,-1)),shift:e=>Z(e,n=>t.EditorSelection.cursor(e.lineBlockAt(n.head).to))},{key:"Ctrl-d",run:em},{key:"Ctrl-h",run:eh},{key:"Ctrl-k",run:e=>ed(e,t=>{let n=e.lineBlockAt(t.head).to;return t.head<n?n:Math.min(e.state.doc.length,t.head+1)})},{key:"Ctrl-Alt-h",run:eO},{key:"Ctrl-o",run:e=>{let{state:n,dispatch:r}=e;if(n.readOnly)return!1;let o=n.changeByRange(e=>({changes:{from:e.from,to:e.to,insert:t.Text.of(["",""])},range:t.EditorSelection.cursor(e.from)}));return r(n.update(o,{scrollIntoView:!0,userEvent:"input"})),!0}},{key:"Ctrl-t",run:e=>{let{state:n,dispatch:r}=e;if(n.readOnly)return!1;let o=n.changeByRange(e=>{if(!e.empty||0==e.from||e.from==n.doc.length)return{range:e};let r=e.from,o=n.doc.lineAt(r),a=r==o.from?r-1:(0,t.findClusterBreak)(o.text,r-o.from,!1)+o.from,i=r==o.to?r+1:(0,t.findClusterBreak)(o.text,r-o.from,!0)+o.from;return{changes:{from:a,to:i,insert:n.doc.slice(r,i).append(n.doc.slice(a,r))},range:t.EditorSelection.cursor(i)}});return!o.changes.empty&&(r(n.update(o,{scrollIntoView:!0,userEvent:"move.character"})),!0)}},{key:"Ctrl-v",run:G}],eE=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:e=>W(e,t=>z(e.state,t,!M(e))),shift:e=>Z(e,t=>z(e.state,t,!M(e)))},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:e=>W(e,t=>z(e.state,t,M(e))),shift:e=>Z(e,t=>z(e.state,t,M(e)))},{key:"Alt-ArrowUp",run:e=>{let{state:t,dispatch:n}=e;return eS(t,n,!1)}},{key:"Shift-Alt-ArrowUp",run:e=>{let{state:t,dispatch:n}=e;return ey(t,n,!1)}},{key:"Alt-ArrowDown",run:e=>{let{state:t,dispatch:n}=e;return eS(t,n,!0)}},{key:"Shift-Alt-ArrowDown",run:e=>{let{state:t,dispatch:n}=e;return ey(t,n,!0)}},{key:"Escape",run:e=>{let{state:n,dispatch:r}=e,o=n.selection,a=null;return o.ranges.length>1?a=t.EditorSelection.create([o.main]):o.main.empty||(a=t.EditorSelection.create([t.EditorSelection.cursor(o.main.head)])),!!a&&(r(N(n,a)),!0)}},{key:"Mod-Enter",run:ew},{key:"Alt-l",mac:"Ctrl-l",run:e=>{let{state:n,dispatch:r}=e,o=ev(n).map(e=>{let{from:r,to:o}=e;return t.EditorSelection.range(r,Math.min(o+1,n.doc.length))});return r(n.update({selection:t.EditorSelection.create(o),userEvent:"select"})),!0}},{key:"Mod-i",run:e=>{let{state:n,dispatch:o}=e,a=T(n.selection,e=>{let o=(0,r.syntaxTree)(n),a=o.resolveStack(e.from,1);if(e.empty){let t=o.resolveStack(e.from,-1);t.node.from>=a.node.from&&t.node.to<=a.node.to&&(a=t)}for(let n=a;n;n=n.next){let{node:r}=n;if((r.from<e.from&&r.to>=e.to||r.to>e.to&&r.from<=e.from)&&n.next)return t.EditorSelection.range(r.to,r.from)}return e});return!a.eq(n.selection)&&(o(N(n,a)),!0)},preventDefault:!0},{key:"Mod-[",run:e=>{let{state:n,dispatch:o}=e;return!n.readOnly&&(o(n.update(eP(n,(e,o)=>{let a=/^\s*/.exec(e.text)[0];if(!a)return;let i=(0,t.countColumn)(a,n.tabSize),l=0,s=(0,r.indentString)(n,Math.max(0,i-(0,r.getIndentUnit)(n)));for(;l<a.length&&l<s.length&&a.charCodeAt(l)==s.charCodeAt(l);)l++;o.push({from:e.from+l,to:e.from+a.length,insert:s.slice(l)})}),{userEvent:"delete.dedent"})),!0)}},{key:"Mod-]",run:e=>{let{state:t,dispatch:n}=e;return!t.readOnly&&(n(t.update(eP(t,(e,n)=>{n.push({from:e.from,insert:t.facet(r.indentUnit)})}),{userEvent:"input.indent"})),!0)}},{key:"Mod-Alt-\\",run:e=>{let{state:t,dispatch:n}=e;if(t.readOnly)return!1;let o=Object.create(null),a=new r.IndentContext(t,{overrideIndentation:e=>{let t=o[e];return null==t?-1:t}}),i=eP(t,(e,n,i)=>{let l=(0,r.getIndentation)(a,e.from);if(null==l)return;/\S/.test(e.text)||(l=0);let s=/^\s*/.exec(e.text)[0],c=(0,r.indentString)(t,l);(s!=c||i.from<e.from+s.length)&&(o[e.from]=l,n.push({from:e.from,to:e.from+s.length,insert:c}))});return i.changes.empty||n(t.update(i,{userEvent:"indent"})),!0}},{key:"Shift-Mod-k",run:e=>{if(e.state.readOnly)return!1;let{state:t}=e,n=t.changes(ev(t).map(e=>{let{from:n,to:r}=e;return n>0?n--:r<t.doc.length&&r++,{from:n,to:r}})),r=T(t.selection,t=>{let n;if(e.lineWrapping){let r=e.lineBlockAt(t.head),o=e.coordsAtPos(t.head,t.assoc||1);o&&(n=r.bottom+e.documentTop-o.bottom+e.defaultLineHeight/2)}return e.moveVertically(t,!0,n)}).map(n);return e.dispatch({changes:n,selection:r,scrollIntoView:!0,userEvent:"delete.line"}),!0}},{key:"Shift-Mod-\\",run:e=>{let{state:n,dispatch:o}=e;return function(e,n,o){let a=!1,i=T(e.selection,n=>{let i=(0,r.matchBrackets)(e,n.head,-1)||(0,r.matchBrackets)(e,n.head,1)||n.head>0&&(0,r.matchBrackets)(e,n.head-1,1)||n.head<e.doc.length&&(0,r.matchBrackets)(e,n.head+1,-1);if(!i||!i.end)return n;a=!0;let l=i.start.from==n.head?i.end.to:i.end.from;return o?t.EditorSelection.range(n.anchor,l):t.EditorSelection.cursor(l)});return!!a&&(n(N(e,i)),!0)}(n,o,!1)}},{key:"Mod-/",run:e=>{let{state:t}=e,n=t.doc.lineAt(t.selection.main.from),r=c(e.state,n.from);return r.line?i(e):!!r.block&&s(e)}},{key:"Alt-A",run:l},{key:"Ctrl-m",mac:"Shift-Alt-m",run:e=>(e.setTabFocusMode(),!0)}].concat([{key:"ArrowLeft",run:X,shift:H,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:e=>j(e,!M(e)),shift:e=>K(e,!M(e)),preventDefault:!0},{mac:"Cmd-ArrowLeft",run:e=>W(e,t=>Y(e,t,!M(e))),shift:e=>Z(e,t=>Y(e,t,!M(e))),preventDefault:!0},{key:"ArrowRight",run:D,shift:J,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:e=>j(e,M(e)),shift:e=>K(e,M(e)),preventDefault:!0},{mac:"Cmd-ArrowRight",run:e=>W(e,t=>Y(e,t,M(e))),shift:e=>Z(e,t=>Y(e,t,M(e))),preventDefault:!0},{key:"ArrowUp",run:B,shift:et,preventDefault:!0},{mac:"Cmd-ArrowUp",run:ei,shift:es},{mac:"Ctrl-ArrowUp",run:U,shift:eo},{key:"ArrowDown",run:V,shift:en,preventDefault:!0},{mac:"Cmd-ArrowDown",run:el,shift:ec},{mac:"Ctrl-ArrowDown",run:G,shift:ea},{key:"PageUp",run:U,shift:eo},{key:"PageDown",run:G,shift:ea},{key:"Home",run:e=>W(e,t=>Y(e,t,!1)),shift:e=>Z(e,t=>Y(e,t,!1)),preventDefault:!0},{key:"Mod-Home",run:ei,shift:es},{key:"End",run:e=>W(e,t=>Y(e,t,!0)),shift:e=>Z(e,t=>Y(e,t,!0)),preventDefault:!0},{key:"Mod-End",run:el,shift:ec},{key:"Enter",run:eb,shift:eb},{key:"Mod-a",run:eu},{key:"Backspace",run:eh,shift:eh},{key:"Delete",run:em},{key:"Mod-Backspace",mac:"Alt-Backspace",run:eO},{key:"Mod-Delete",mac:"Alt-Delete",run:e=>eg(e,!0)},{mac:"Mod-Backspace",run:e=>ed(e,t=>{let n=e.moveToLineBoundary(t,!1).head;return t.head>n?n:Math.max(0,t.head-1)})},{mac:"Mod-Delete",run:e=>ed(e,t=>{let n=e.moveToLineBoundary(t,!0).head;return t.head<n?n:Math.min(e.state.doc.length,t.head+1)})}].concat(eC.map(e=>({mac:e.key,run:e.run,shift:e.shift}))))},224203,e=>{"use strict";e.s(["lintKeymap",()=>m]);var t=e.i(334283),n=e.i(650218),r=e.i(141016);class o{constructor(e,t,n){this.from=e,this.to=t,this.diagnostic=n}}class a{static init(e,r,o){let l=o.facet(g).markerFilter;l&&(e=l(e,o));let s=e.slice().sort((e,t)=>e.from-t.from||e.to-t.to),c=new n.RangeSetBuilder,u=[],d=0;for(let e=0;;){let n,r,a=e==s.length?null:s[e];if(!a&&!u.length)break;for(u.length?(n=d,r=u.reduce((e,t)=>Math.min(e,t.to),a&&a.from>n?a.from:1e8)):(n=a.from,r=a.to,u.push(a),e++);e<s.length;){let t=s[e];if(t.from==n&&(t.to>t.from||t.to==n))u.push(t),e++,r=Math.min(t.to,r);else{r=Math.min(t.from,r);break}}let i=P(u);if(u.some(e=>e.from==e.to||e.from==e.to-1&&o.doc.lineAt(e.from).to==e.from))c.add(n,n,t.Decoration.widget({widget:new S(i),diagnostics:u.slice()}));else{let e=u.reduce((e,t)=>t.markClass?e+" "+t.markClass:e,"");c.add(n,r,t.Decoration.mark({class:"cm-lintRange cm-lintRange-"+i+e,diagnostics:u.slice(),inclusiveEnd:u.some(e=>e.to>r)}))}d=r;for(let e=0;e<u.length;e++)u[e].to<=d&&u.splice(e--,1)}let f=c.finish();return new a(f,r,i(f))}constructor(e,t,n){this.diagnostics=e,this.panel=t,this.selected=n}}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=null;return e.between(n,1e9,(e,n,a)=>{let{spec:i}=a;if(!(t&&0>i.diagnostics.indexOf(t)))if(r){if(0>i.diagnostics.indexOf(r.diagnostic))return!1;r=new o(r.from,n,r.diagnostic)}else r=new o(e,n,t||i.diagnostics[0])}),r}function l(e,t){let n=t.pos,r=t.end||n,o=e.state.facet(g).hideOn(e,n,r);if(null!=o)return o;let a=e.startState.doc.lineAt(t.pos);return!!(e.effects.some(e=>e.is(s))||e.changes.touchesRange(a.from,Math.max(a.to,r)))}let s=n.StateEffect.define(),c=n.StateEffect.define(),u=n.StateEffect.define(),d=n.StateField.define({create:()=>new a(t.Decoration.none,null,null),update(e,t){if(t.docChanged&&e.diagnostics.size){let n=e.diagnostics.map(t.changes),r=null,o=e.panel;if(e.selected){let o=t.changes.mapPos(e.selected.from,1);r=i(n,e.selected.diagnostic,o)||i(n,null,o)}!n.size&&o&&t.state.facet(g).autoPanel&&(o=null),e=new a(n,o,r)}for(let n of t.effects)if(n.is(s)){let r=t.state.facet(g).autoPanel?n.value.length?b.open:null:e.panel;e=a.init(n.value,r,t.state)}else n.is(c)?e=new a(e.diagnostics,n.value?b.open:null,e.selected):n.is(u)&&(e=new a(e.diagnostics,e.panel,n.value));return e},provide:e=>[t.showPanel.from(e,e=>e.panel),t.EditorView.decorations.from(e,e=>e.diagnostics)]}),f=t.Decoration.mark({class:"cm-lintRange cm-lintRange-active"});function p(e,t){return(0,r.default)("ul",{class:"cm-tooltip-lint"},t.map(t=>v(e,t,!1)))}let h=e=>{let t=e.state.field(d,!1);return!!t&&!!t.panel&&(e.dispatch({effects:c.of(!1)}),!0)},m=[{key:"Mod-Shift-m",run:e=>{let r=e.state.field(d,!1);r&&r.panel||e.dispatch({effects:function(e,t){return e.field(d,!1)?t:t.concat(n.StateEffect.appendConfig.of(k))}(e.state,[c.of(!0)])});let o=(0,t.getPanel)(e,b.open);return o&&o.dom.querySelector(".cm-panel-lint ul").focus(),!0},preventDefault:!0},{key:"F8",run:e=>{let t=e.state.field(d,!1);if(!t)return!1;let n=e.state.selection.main,r=t.diagnostics.iter(n.to+1);return(!!r.value||!!(r=t.diagnostics.iter(0)).value&&(r.from!=n.from||r.to!=n.to))&&(e.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0}),!0)}}],g=n.Facet.define({combine:e=>Object.assign({sources:e.map(e=>e.source).filter(e=>null!=e)},(0,n.combineConfig)(e.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,t)=>e?t?n=>e(n)||t(n):e:t}))});function O(e){let t=[];if(e)e:for(let{name:n}of e){for(let e=0;e<n.length;e++){let r=n[e];if(/[a-zA-Z]/.test(r)&&!t.some(e=>e.toLowerCase()==r.toLowerCase())){t.push(r);continue e}}t.push("")}return t}function v(e,t,n){var o;let a=n?O(t.actions):[];return(0,r.default)("li",{class:"cm-diagnostic cm-diagnostic-"+t.severity},(0,r.default)("span",{class:"cm-diagnosticText"},t.renderMessage?t.renderMessage(e):t.message),null==(o=t.actions)?void 0:o.map((n,o)=>{let l=!1,s=r=>{if(r.preventDefault(),l)return;l=!0;let o=i(e.state.field(d).diagnostics,t);o&&n.apply(e,o.from,o.to)},{name:c}=n,u=a[o]?c.indexOf(a[o]):-1,f=u<0?c:[c.slice(0,u),(0,r.default)("u",c.slice(u,u+1)),c.slice(u+1)];return(0,r.default)("button",{type:"button",class:"cm-diagnosticAction",onclick:s,onmousedown:s,"aria-label":" Action: ".concat(c).concat(u<0?"":' (access key "'.concat(a[o],')"'),".")},f)}),t.source&&(0,r.default)("div",{class:"cm-diagnosticSource"},t.source))}class S extends t.WidgetType{eq(e){return e.sev==this.sev}toDOM(){return(0,r.default)("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}constructor(e){super(),this.sev=e}}class y{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(0xffffffff*Math.random()).toString(16),this.dom=v(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class b{get selectedIndex(){let e=this.view.state.field(d).selected;if(!e)return -1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return -1}update(){let{diagnostics:e,selected:t}=this.view.state.field(d),n=0,r=!1,o=null,a=new Set;for(e.between(0,this.view.state.doc.length,(e,i,l)=>{let{spec:s}=l;for(let e of s.diagnostics){if(a.has(e))continue;a.add(e);let i=-1,l;for(let t=n;t<this.items.length;t++)if(this.items[t].diagnostic==e){i=t;break}i<0?(l=new y(this.view,e),this.items.splice(n,0,l),r=!0):(l=this.items[i],i>n&&(this.items.splice(n,i-n),r=!0)),t&&l.diagnostic==t.diagnostic?l.dom.hasAttribute("aria-selected")||(l.dom.setAttribute("aria-selected","true"),o=l):l.dom.hasAttribute("aria-selected")&&l.dom.removeAttribute("aria-selected"),n++}});n<this.items.length&&!(1==this.items.length&&this.items[0].diagnostic.from<0);)r=!0,this.items.pop();0==this.items.length&&(this.items.push(new y(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),r=!0),o?(this.list.setAttribute("aria-activedescendant",o.id),this.view.requestMeasure({key:this,read:()=>({sel:o.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:e=>{let{sel:t,panel:n}=e,r=n.height/this.list.offsetHeight;t.top<n.top?this.list.scrollTop-=(n.top-t.top)/r:t.bottom>n.bottom&&(this.list.scrollTop+=(t.bottom-n.bottom)/r)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),r&&this.sync()}sync(){let e=this.list.firstChild;function t(){let t=e;e=t.nextSibling,t.remove()}for(let n of this.items)if(n.dom.parentNode==this.list){for(;e!=n.dom;)t();e=n.dom.nextSibling}else this.list.insertBefore(n.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=i(this.view.state.field(d).diagnostics,this.items[e].diagnostic);t&&this.view.dispatch({selection:{anchor:t.from,head:t.to},scrollIntoView:!0,effects:u.of(t)})}static open(e){return new b(e)}constructor(e){this.view=e,this.items=[];let t=t=>{if(27==t.keyCode)h(this.view),this.view.focus();else if(38==t.keyCode||33==t.keyCode)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(40==t.keyCode||34==t.keyCode)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(36==t.keyCode)this.moveSelection(0);else if(35==t.keyCode)this.moveSelection(this.items.length-1);else if(13==t.keyCode)this.view.focus();else{if(!(t.keyCode>=65)||!(t.keyCode<=90)||!(this.selectedIndex>=0))return;let{diagnostic:n}=this.items[this.selectedIndex],r=O(n.actions);for(let o=0;o<r.length;o++)if(r[o].toUpperCase().charCodeAt(0)==t.keyCode){let t=i(this.view.state.field(d).diagnostics,n);t&&n.actions[o].apply(e,t.from,t.to)}}t.preventDefault()},n=e=>{for(let t=0;t<this.items.length;t++)this.items[t].dom.contains(e.target)&&this.moveSelection(t)};this.list=(0,r.default)("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:n}),this.dom=(0,r.default)("div",{class:"cm-panel-lint"},this.list,(0,r.default)("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>h(this.view)},"×")),this.update()}}function w(e){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:'viewBox="0 0 40 40"';return'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" '.concat(t,">").concat(encodeURIComponent(e),"</svg>')")}('<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="'.concat(e,'" fill="none" stroke-width=".7"/>'),'width="6" height="3"')}let x=t.EditorView.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:w("#d11")},".cm-lintRange-warning":{backgroundImage:w("orange")},".cm-lintRange-info":{backgroundImage:w("#999")},".cm-lintRange-hint":{backgroundImage:w("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function P(e){let t="hint",n=1;for(let o of e){var r;let e="error"==(r=o.severity)?4:"warning"==r?3:"info"==r?2:1;e>n&&(n=e,t=o.severity)}return t}t.GutterMarker;let C=n.StateEffect.define(),E=n.StateField.define({create:()=>null,update:(e,t)=>(e&&t.docChanged&&(e=l(t,e)?null:Object.assign(Object.assign({},e),{pos:t.changes.mapPos(e.pos)})),t.effects.reduce((e,t)=>t.is(C)?t.value:e,e)),provide:e=>t.showTooltip.from(e)}),k=[d,t.EditorView.decorations.compute([d],e=>{let{selected:n,panel:r}=e.field(d);return n&&r&&n.from!=n.to?t.Decoration.set([f.range(n.from,n.to)]):t.Decoration.none}),(0,t.hoverTooltip)(function(e,t,n){let{diagnostics:r}=e.state.field(d),o,a=-1,i=-1;r.between(t-(n<0),t+ +(n>0),(e,r,l)=>{let{spec:s}=l;if(t>=e&&t<=r&&(e==r||(t>e||n>0)&&(t<r||n<0)))return o=s.diagnostics,a=e,i=r,!1});let l=e.state.facet(g).tooltipFilter;return(o&&l&&(o=l(o,e.state)),o)?{pos:a,end:i,above:e.state.doc.lineAt(a).to<i,create:()=>({dom:p(e,o)})}:null},{hideOn:l}),x],Q=n.Facet.define({combine:e=>(0,n.combineConfig)(e,{hoverTime:300,markerFilter:null,tooltipFilter:null})})},837433,e=>{"use strict";e.s(["basicSetup",()=>c,"monoFontFamily",()=>d,"sansFontFamily",()=>u,"singleLineSetup",()=>l]);var t=e.i(874838),n=e.i(162284),r=e.i(255791),o=e.i(224203),a=e.i(650218),i=e.i(334283);let l=[a.EditorState.transactionFilter.of(e=>e.newDoc.lines>1?[e,{changes:{from:0,to:e.newDoc.length,insert:e.newDoc.sliceString(0,void 0," ").trim()},sequential:!0}]:[e])];(0,i.lineNumbers)(),(0,i.highlightActiveLine)(),(0,i.highlightActiveLineGutter)(),(0,r.foldGutter)();let s=[{key:"Tab",run:t.acceptCompletion,stopPropagation:!0},{key:"Enter",run:t.acceptCompletion,stopPropagation:!0},{key:"Escape",run:t.closeCompletion,stopPropagation:!0}],c=[(0,n.history)(),(0,i.highlightSpecialChars)(),(0,i.drawSelection)(),(0,i.dropCursor)(),a.EditorState.allowMultipleSelections.of(!0),(0,r.indentOnInput)(),(0,r.syntaxHighlighting)(r.defaultHighlightStyle,{fallback:!0}),(0,r.bracketMatching)(),(0,t.closeBrackets)(),(0,t.autocompletion)({icons:!1}),(0,i.rectangularSelection)(),(0,i.crosshairCursor)(),i.keymap.of([...t.closeBracketsKeymap,...n.defaultKeymap.filter(e=>"Enter"!==e.key),...n.historyKeymap,...r.foldKeymap,...t.completionKeymap,...s,...o.lintKeymap])];i.EditorView.updateListener.of(e=>{let{docChanged:n,view:r,state:o}=e,a=(n||r.hasFocus)&&!(0,t.completionStatus)(o);!o.doc.length&&a&&(0,t.startCompletion)(r)});let u=i.EditorView.theme({"& .cm-scroller":{fontFamily:"var(--cm-sans-font, inherit) !important"}}),d=i.EditorView.theme({"& .cm-scroller":{fontFamily:"var(--cm-mono-font, inherit) !important"}})},116132,e=>{"use strict";e.s(["FormulaTextEditor",()=>e_,"default",()=>eF,"formulaEditorProvider",()=>eV],116132);var t,n,r=e.i(637651),o=e.i(162284),a=e.i(650218),i=e.i(334283),l=e.i(353315),s=e.i(211959),c=e.i(596222),u=e.i(837433),d=e.i(406845),f=e.i(476238),p=e.i(255791),h=e.i(380495),m=e.i(935777);e.s(["ArgList",()=>Y,"Argument",()=>Z,"ArrayColumns",()=>K,"ArrayConstant",()=>et,"ArrayRows",()=>ee,"BoolToken",()=>x,"BuiltInFunctionName",()=>y,"CellToken",()=>R,"CloseParen",()=>X,"ColRangeToken",()=>T,"CompareOp",()=>H,"Constant",()=>V,"ConstantArray",()=>J,"ErrorToken",()=>w,"Formula",()=>E,"FormulaInfixOp",()=>$,"FormulaWithEq",()=>C,"FunctionCall",()=>U,"FunctionName",()=>G,"MultipleSheetsQuotedToken",()=>B,"MultipleSheetsToken",()=>_,"NameToken",()=>A,"Number",()=>F,"OpenParen",()=>I,"Quote",()=>j,"RangeToken",()=>q,"RefErrorToken",()=>b,"Reference",()=>k,"ReferenceFunctionCall",()=>W,"ReferenceItem",()=>Q,"RowRangeToken",()=>N,"Script",()=>P,"Separator",()=>O,"SheetQuotedToken",()=>z,"SheetToken",()=>D,"TextToken",()=>L,"Union",()=>M,"arrayRowSeparator",()=>S,"decimalSeparator",()=>v,"intersecop",()=>g],696423);let g=48,O=1,v=49,S=50,y=2,b=3,w=4,x=5,P=6,C=7,E=8,k=9,Q=10,R=11,A=12,T=13,N=14,W=15,q=16,I=17,M=18,X=19,D=20,j=21,z=22,_=23,B=24,V=25,F=26,L=27,U=28,G=29,Y=30,Z=31,$=32,H=37,J=38,K=39,ee=40,et=41;var en=e.i(696423),er=e.i(865125);let eo=new Set([9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288]),ea=e=>e>=65&&e<=90||e>=97&&e<=122,ei=e=>e>=48&&e<=57,el=e=>eo.has(e),es=new m.ExternalTokenizer(e=>{let{next:t}=e;if(!el(t))return;let n=e.peek(-1);if(ei(n)||ea(n)||41===n||92===n||95===n||46===n||63===n||8364===n){do t=e.advance();while(el(t))if(ea(t)||ei(t)||40===t||92===t||95===t)return e.acceptToken(en.intersecop)}},{contextual:!0}),ec={".":46,",":44};function eu(e){return new m.ExternalTokenizer(t=>{if(t.next===ec[e])return t.acceptToken(en.decimalSeparator,1)})}let ed={".":44,",":59};function ef(e){return new m.ExternalTokenizer(t=>{if(t.next===ed[e])return t.acceptToken(en.Separator,1)})}let ep={".":",",",":"\\"};function eh(e){return t=>t===ep[e]?en.arrayRowSeparator:-1}let em=eu("."),eg=ef("."),eO=eh("."),ev=function(e){return t=>e.refError.includes(t.toUpperCase())?en.RefErrorToken:e.error.includes(t.toUpperCase())?en.ErrorToken:-1}(er.default),eS=(t=er.default,e=>t.bool.includes(e.toUpperCase())?en.BoolToken:-1),ey=(n=er.default,e=>n.formulas[e.toUpperCase()]?en.BuiltInFunctionName:-1),eb=m.LRParser.deserialize({version:14,states:"0nO!dQ[OOOOQR'#Cf'#CfO#uQcO'#CfO$wQaO'#CdOOQR'#Ck'#CkO%UQ[O'#CdOOQO'#Dg'#DgO%`QpO'#DgOOQR'#Ce'#CeO%hQWO'#CeOOQU'#DX'#DXO&hQdO'#CvO&xQWO'#CvOOQQ'#Cu'#CuO'iQ`O'#DcO'pQ`O'#CxO%XQ[O'#CxOOQQ'#Cx'#CxO(dQ[O'#DSOOQQ'#Cd'#CdO(kQ[O'#CcOOQO'#Dc'#DcQOQWOOO(uQWO,59WO(uQWO,59VOOQR,59V,59VO)dQcO,59PO)nQWO,59VO)sQ`O,59OO'uQ[O'#DSOOQQ,59O,59OOOQO,5:R,5:ROOQR,59P,59POOQU-E7V-E7VO*iQ`O,59bOOQQ,59b,59bOOQS'#C}'#C}OOQS'#DO'#DOOOQS'#DP'#DPOOQS'#DQ'#DQO%XQ[O,59hO%XQ[O,59hO%XQ[O,59hO%XQ[O,59hO%XQ[O,59hOOQQ,59d,59dO*vQ!hO'#CzO,^Q`O,59dO,kQ[O'#CvOOQS'#Dv'#DvOOQO'#DV'#DVO,|Q[O'#DVO-UQWO'#DUO-aQWO'#DTO-iQWO,59nO%XQ[O,5:eO-nQ`O,58}OOQR1G.r1G.rO-uQWO'#CkO/XQcO1G.qO-uQWO'#DWO/iQYO,59YOOQR1G.k1G.kOOQR1G.q1G.qOOQQ1G.j1G.jO0`Q`O1G.|O1_Q`O1G/SO2TQ`O1G/SO2_Q`O1G/SO3WQ`O1G/SO3_Q`O1G/SO3fQ#wO'#CfO3mQ#wO'#CdO4hQ#zO'#CvO5aQ#vO'#C{O5kQ!dO,59fO5sQWO,59bOOQO,59q,59qO'uQ[O'#DZO6RQWO,59pO6^QWO,59oO'uQ[O'#D[OOQQ1G/Y1G/YO6fQ`O1G0PO6mQZO'#CfO7_QZO,59PO7pQZO,59rOOQQ-E7U-E7UO8RQ#vO,59bO*vQ!hO'#DYO8]Q!dO1G/QOOQQ1G/Q1G/QO8eQ#vO,59dO8oQWO1G.|OOQO,59u,59uOOQO-E7X-E7XOOQO-E7Y-E7YOOQO,59v,59vOOQO7+%k7+%kO8}Q#wO1G.qO9XQ#vO1G.|O:QQ#vO1G/SO:sQ#vO1G/SO:}Q#vO1G/SO;sQ#vO1G/SO;zQ#vO1G/SOOQQ,59t,59tOOQQ-E7W-E7WOOQQ7+$l7+$lO<RQZO1G.qO<dQ[O'#CxO=tQWO,59WO-uQWO,59WO=tQWO,59VO-uQWO,59VO<dQ[O,59hO<dQ[O,59hO<dQ[O,59hO<dQ[O,59hO<dQ[O,59h",stateData:">v~O!UOS~OQ_ORQOS]OT]OZPO[PO]PO^POaTOdUOeVOgUOk]Om_O!R[O![YO!_`O!``O!a`O~O!WdO!ibO~PVOR!ZXZ!ZX[!ZX]!ZX^!ZXuYX!QYX!XYX!YYX!bYX!cYX!dYX!eYX!fYX!gYX!hYXPYX~O!PYXcYX!lYX~P!nO!QhO!XgO!YiOuWX!bWX!cWX!dWX!eWX!fWX!gWX!hWX~O!PWXcWX!lWX~P$SOcnO!imO~PVOfoOhoO~ORPOZPO[PO]PO^PO~O![YOujX!bjX!cjX!djX!ejX!fjX!gjX!hjX~O!RrO!PjXcjX!ljX~P%yO![sO~Ou|O!b}O!ctO!duO!euO!fvO!gvO!hwO~O!P!VX~P&}O!]!OO~OR!SOS]OT]Ok]O!R[O![YO!_!RO!`!RO!a!RO~O!W!XO~P'uO!imO!PVX~PVORQOZPO[PO]PO^POa![OdUOeVOgUO~OP!^Oc!`O~P$SOc!aO~Oc!bO~P&}O![YOuja!bja!cja!dja!eja!fja!gja!hja~O!Pjacja!lja~P)zOQ_OR!iOS]OT]OZPO[PO]PO^POaTOdUOeVOgUOk]Om_O!R[O![YO!_#bO!`#bO!a#bO!imOPoP!^oP~O!Placla!lla~P&}O!R!nO![YO!SjX!kjX!ljX~O!R[O![YO~O!S!pO!kxX!lxX~O!k!sO!lwX~O!l!tO~O!PVa~P&}OR!vOZPO[PO]PO^POa![OdUOeVOgUO~Ou_i!Q_i!Y_i!b_i!c_i!d_i!e_i!f_i!g_i!h_iP_i~O!XgO!P_ic_i!l_i~P.dOP!^Ocba~O![YOuji!bji!cji!dji!eji!fji!gji!hji~O!Pjicji!lji~P/qO!b}Oupi!Ppi!dpi!epi!fpi!gpi!hpicpi!lpi~O!cpi~P0mO!b}O!ctOupi!Ppi!dpi!epi!hpicpi!lpi~O!fvO!gvO~P1fO!ctO~P0mO!b}O!ctO!duO!euO!fvO!gvOupi!Ppicpi!lpi~O!hpi~P2fO!hwO~P2fO!^YX~P!nO!Q#eO!X#cO!YiOPWXuWX!^WX!bWX!cWX!dWX!eWX!fWX!gWX!hWX~O!R!zOPjX!^jX~P%yOu#kO!b}O!ctO!duO!euO!fvO!gvO!hwO~OPoX!^oX~P4uOP!{O!^!}O~O![YO!Sja!kja!lja~O!S!pO!kxa!lxa~O!k!sO!lwa~O!l#UO~P&}OPYXR!ZXZ!ZX[!ZX]!ZX^!ZXcYX!QYX!XYX!YYX~OP!^Oc!`O!Q#fO!X#dO!YiO~O!Q#fO!X#dO!YiOPzacza~OPja!^ja~P)zOP!{O!^#`O~OPla!^la~P4uO![YO!Sji!kji!lji~O!X#cO!^_i~P.dOPji!^ji~P/qO!b}OPpiupi!^pi!dpi!epi!fpi!gpi!hpi~O!cpi~P9cO!b}O!ctOPpiupi!^pi!dpi!epi!hpi~O!fvO!gvO~P:XO!ctO~P9cO!b}O!ctO!duO!euO!fvO!gvOPpiupi!^pi~O!hpi~P;UO!hwO~P;UO!X#dOP_ic_i!Q_i!Y_i~OQ_OR!iOS]OT]OZPO[PO]PO^POaTOdUOeVOgUOk]Om_O!R[O![YO!_#bO!`#bO!a#bO!imO~OR!iOZPO[PO]PO^POa![OdUOeVOgUO~O^hfgkd![]Z!nm[!o!Y!a!_!UZ~",goto:"-W!nPPPPPPP!o!r#x$vPPPP%g&TP&qPPPPPP&u'aP'|P(b(e(k)P)d)s*UP'|*c*g*n*v*}+},T,ZPPPPPP,aPPP,dPPPPPPPPPPPPPP-QPP!oReOQ^OQlTQ!P`Q!YdQ!dxQ!eyQ!fzQ!g{Q!h|S!l!O!{Q!u!XQ#O#bQ#X#gQ#Y#hQ#Z#iQ#[#jR#]#kbRO`dxyz{|!XQjTU!Zg#c#dQ!]h`!j!O!{#b#g#h#i#j#kQ!w![Q!x!^Q#V#eR#a#f!UWOT`dghxyz{|!O!X![!^!{#b#c#d#e#f#g#h#i#j#kRpX!VWOT`dghxyz{|!O!X![!^!{#b#c#d#e#f#g#h#i#j#k!VSOT`dghxyz{|!O!X![!^!{#b#c#d#e#f#g#h#i#j#kTkT![tcOT`dxyz{|!O!X!{#b#g#h#i#j#kX!Sbm!p!s|]OT`bdmxyz{|!O!X!p!s!{#b#g#h#i#j#kR!o!TucOT`dxyz{|!O!X!{#b#g#h#i#j#kR}_Q!m!OR#^!{uaOT`dxyz{|!O!X!{#b#g#h#i#j#kbx^l!P!Y!e!f!g!h!u]#g!l#O#Y#Z#[#]^y^l!P!Y!g!h!uX#h!l#O#[#]`z^l!P!Y!e!g!h!uZ#i!l#O#Y#[#][{^l!P!Y!h!uV#j!l#O#]T!WbmS!VbmR#T!sU!Ubm!sR#Q!pS!_j!wR!y!_dZOT`dxyz{|!X[qZ!Q!c!k#P#WY!Qbm!T!p!sQ!cr`!k!O!{#b#g#h#i#j#kQ#P!nR#W!zQ!|!mR#_!|Q!q!UR#R!qQ!r!VR#S!rRfO!VXOT`dghxyz{|!O!X![!^!{#b#c#d#e#f#g#h#i#j#kX!Tbm!p!s",nodeNames:"⚠ Separator BuiltInFunctionName RefErrorToken ErrorToken BoolToken Script FormulaWithEq Formula Reference ReferenceItem CellToken NameToken ColRangeToken RowRangeToken ReferenceFunctionCall RangeToken OpenParen Union CloseParen SheetToken Quote SheetQuotedToken MultipleSheetsToken MultipleSheetsQuotedToken Constant Number TextToken FunctionCall FunctionName ArgList Argument FormulaInfixOp ArithOp ArithOp ArithOp ArithOp CompareOp ConstantArray ArrayColumns ArrayRows ArrayConstant",maxTerm:77,nodeProps:[["closedBy",17,"CloseParen"],["openedBy",19,"OpenParen"]],skippedNodes:[0],repeatNodeCount:5,tokenData:"#(W~RyOX#rXY/XYZ/XZ]#r]^/X^p#rpq1Xqr#rrs2fstHetuK_uv!6[vw!7Swx!7zxy!8Syz!8|z{!9v{|!9{|}!;n}!O!<f!O!P#r!P!Q!=`!Q![!=e![!]!?U!]!^!?Z!^!_!@R!_!`!Aw!`!a!Bq!b!c!Co!c!}!E`#O#P#%P#Q#R#%p#R#S!Gh#S#T#r#T#o!E`#o#p#&h#p#q#r#q#r#'`#r;'S#r;'S;=`/R<%lO#r]#uhOp#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![#r![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#rS%dZOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%aS&YQqr&`wx%aS&eOfSS&hYOw'Wwx(_xz'W{!P'W!Q!['W!]!a'W!b!}'W#Q;'S'W;'S;=`(X<%lO'WS'ZYOw'Wwx'yxz'W{!P'W!Q!['W!]!a'W!b!}'W#Q;'S'W;'S;=`(X<%lO'WS'|Qqr(Swx'WS(XOhSS([P;=`<%l'WS(bPwx'WS(hP;=`<%l%a](phdXOp#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![#r![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r]*_fOp+spq'Wqs+sst'Wtu+suw'Wwx(_xz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!}+s#Q#R'W#R#o+s#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s]+vgOp+spq'Wqr-_rs+sst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!}+s#Q#R'W#R#o+s#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s]-dggXOp+spq'Wqr-_rs+sst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!}+s#Q#R'W#R#o+s#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s]/OP;=`<%l+s]/UP;=`<%l#r~/^m!U~OX#rXY/XYZ/XZ]#r]^/X^p#rpq1Xqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![#r![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~1^b!U~OX%aXY1XYZ1XZ]%a]^1X^p%apq1Xqw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%a~2ilOp2fpq4aqr=[rs?Xst4atu2fuw4awx6gxz4az{7S{|2f|!O4a!O!P2f!P!Q7S!Q![2f![!]@x!]!a4a!a!b7S!b!}2f!}#Q7S#Q#R4a#R#o2f#o#p4a#p#q2f#q#r4a#r;'S2f;'S;=`H_<%lO2f~4daOr4ars5isw4awx6gxz4az{7S{!P4a!P!Q7S!Q![4a![!]8Y!]!a4a!a!b7S!b!}4a!}#Q7S#Q;'S4a;'S;=`=U<%lO4a~5n]k~Or%ars4asw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%a~6jWOq7Sqr7trs7fsw7Swx4ax;'S7S;'S;=`7n<%lO7S~7VTOr7Srs7fs;'S7S;'S;=`7n<%lO7S~7kPk~rs7S~7qP;=`<%l7S~7yTfSOr7Srs7fs;'S7S;'S;=`7n<%lO7S~8]aOr9brs:jsw9bwx<lxz9bz{7S{!P9b!P!Q7S!Q![9b![!]7S!]!a9b!a!b7S!b!}9b!}#Q7S#Q;'S9b;'S;=`<f<%lO9b~9eaOr9brs:jsw9bwx;exz9bz{7S{!P9b!P!Q7S!Q![9b![!]7S!]!a9b!a!b7S!b!}9b!}#Q7S#Q;'S9b;'S;=`<f<%lO9b~:o[k~Or'Wrs9bsw'Wwx'yxz'W{!P'W!Q!['W!]!a'W!b!}'W#Q;'S'W;'S;=`(X<%lO'W~;hWOq7Sqr<Qrs7fsw7Swx9bx;'S7S;'S;=`7n<%lO7S~<VThSOr7Srs7fs;'S7S;'S;=`7n<%lO7S~<iP;=`<%l9b~<oVOr7Srs7fsw7Swx9bx;'S7S;'S;=`7n<%lO7S~=XP;=`<%l4a~=aldXOp2fpq4aqr=[rs?Xst4atu2fuw4awx6gxz4az{7S{|2f|!O4a!O!P2f!P!Q7S!Q![2f![!]@x!]!a4a!a!b7S!b!}2f!}#Q7S#Q#R4a#R#o2f#o#p4a#p#q2f#q#r4a#r;'S2f;'S;=`H_<%lO2f~?^hk~Op#rpq%aqr(krs2fst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![#r![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~@{lOpBspq9bqrBsrsFkst9btuBsuw9bwx<lxz9bz{7S{|Bs|!O9b!O!PBs!P!Q7S!Q![Bs![!]7S!]!a9b!a!b7S!b!}Bs!}#Q7S#Q#R9b#R#oBs#o#p9b#p#qBs#q#r9b#r;'SBs;'S;=`HX<%lOBs~BvlOpBspq9bqrDnrsFkst9btuBsuw9bwx;exz9bz{7S{|Bs|!O9b!O!PBs!P!Q7S!Q![Bs![!]7S!]!a9b!a!b7S!b!}Bs!}#Q7S#Q#R9b#R#oBs#o#p9b#p#qBs#q#r9b#r;'SBs;'S;=`HX<%lOBs~DslgXOpBspq9bqrDnrsFkst9btuBsuw9bwx;exz9bz{7S{|Bs|!O9b!O!PBs!P!Q7S!Q![Bs![!]7S!]!a9b!a!b7S!b!}Bs!}#Q7S#Q#R9b#R#oBs#o#p9b#p#qBs#q#r9b#r;'SBs;'S;=`HX<%lOBs~Fpgk~Op+spq'Wqr-_rsBsst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!}+s#Q#R'W#R#o+s#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~H[P;=`<%lBs~HbP;=`<%l2f~Hj[!Y~Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!c%a!c!}I`#Q;'S%a;'S;=`(e<%lO%a~Ied!o~Oq%aqrI`rw%awx&Vxz%a{!P%a!P!QJs!Q![I`![!]&e!]!a%a!a!bJs!b!c%a!c!}I`#Q#R%a#R#SI`#S%r%a%r%sI`%s;'S%a;'S;=`(e<%lO%a~JxV!o~qrJs!P!QJs!Q![Js!a!bJs!c!}Js#R#SJs%r%sJs~KbjOp#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![MS![!]*[!]!a%a!b!c#r!c!}!%b#Q#R%a#R#T#r#T#o!%b#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~MVhOp#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![MS![!]Nq!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~NtfOp+spq'Wqs+sst'Wtu!!Yuw'Wwx(_xz'W{|+s|!O'W!O!P+s!Q![!#t!]!a'W!b!}+s#Q#R'W#R#o+s#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~!!]gOp+spq'Wqr-_rs+sst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![!#t!]!a'W!b!}+s#Q#R'W#R#o+s#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~!#yg^~Op+spq'Wqr-_rs+sst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![!#t!]!a'W!b!}+s#Q#R'W#R#o+s#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~!%ejOp#rpq%aqr(krs#rst%atu!'Vuw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![!(t![!]!*e!]!a%a!b!c#r!c!}!2x#Q#R%a#R#T#r#T#o!2x#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~!'YhOp#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![!(t![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~!(yhZ~Op#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![!(t![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~!*hhOp+spq'Wqs+sst'Wtu!,Suw'Wwx(_xz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!c+s!c!}!-t#Q#R'W#R#T+s#T#o!-t#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~!,ViOp+spq'Wqr-_rs+sst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!c+s!c!}!-t#Q#R'W#R#T+s#T#o!-t#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~!-yi]~Op+spq'Wqr-_rs+sst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!c+s!c!}!/h#Q#R'W#R#T+s#T#o!/h#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~!/mi]~Op+spq'Wqr-_rs+sst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!c+s!c!}!1[#Q#R'W#R#T+s#T#o!1[#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~!1ag]~Op+spq'Wqr-_rs+sst'Wtu+suw'Wwx'yxz'W{|+s|!O'W!O!P+s!Q![+s!]!a'W!b!}+s#Q#R'W#R#o+s#o#p'W#p#q+s#q#r'W#r;'S+s;'S;=`.{<%lO+s~!2{jOp#rpq%aqr(krs#rst%atu!'Vuw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![!(t![!]!*e!]!a%a!b!c#r!c!}!4m#Q#R%a#R#T#r#T#o!4m#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~!4phOp#rpq%aqr(krs#rst%atu!'Vuw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![!(t![!]!*e!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#rf!6aZ!bbOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%af!7XZ!hbOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%a]!8PPeXwx%a_!8ZZ!]QaXOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%ao!9TZ!^hcROw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%a~!9{O!f~o!:Sh!db!_XOp#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![#r![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~!;sZ!n~Ow%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%ao!<mZ!eb!`XOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%a~!=eO!g~~!=jh![~Op#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![!=e![!]Nq!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~!?ZO!X~T!?`Z!kPOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%af!@W]ubOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!_%a!_!`!AP!`!a!AP!b!}%a#Q;'S%a;'S;=`(e<%lO%af!AUZubOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%ag!BOZub!WPOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%af!Bv]ubOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!_%a!_!`!AP!`!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%a~!Cth!a~Op#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P#r!Q![#r![!]*[!]!a%a!b!}#r#Q#R%a#R#o#r#o#p%a#p#q#r#q#r%a#r;'S#r;'S;=`/R<%lO#r~!Egom~[~Op#rpq%aqr(krs#rst%atu!'Vuw%awx&Vxz%a{|#r|!O%a!O!P!Gh!Q![!Le![!]!*e!]!a%a!a!b!Ip!b!c#r!c!}!No#O#P!Ip#Q#R%a#R#S!Gh#S#T#r#T#o!No#o#p%a#p#q#r#q#r%a#r$Lv#r$Lv$Lw!J_$Lw;'S#r;'S;=`/R<%lO#r~!Goom~[~Op#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P!Gh!Q![!Gh![!]*[!]!a%a!a!b!Ip!b!c#r!c!}!Gh#O#P!Ip#Q#R%a#R#S!Gh#S#T#r#T#o!Gh#o#p%a#p#q#r#q#r%a#r$Lv#r$Lv$Lw!J_$Lw;'S#r;'S;=`/R<%lO#r~!IuW[~!O!P!Ip!Q![!Ip!a!b!Ip!c!}!Ip#O#P!Ip#R#S!Ip#T#o!Ip$Lv$Lw!Ip~!Jdo[~Op#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P!J_!Q![!J_![!]*[!]!a%a!a!b!Ip!b!c#r!c!}!J_#O#P!Ip#Q#R%a#R#S!J_#S#T#r#T#o!J_#o#p%a#p#q#r#q#r%a#r$Lv#r$Lv$Lw!J_$Lw;'S#r;'S;=`/R<%lO#r~!LnoZ~m~[~Op#rpq%aqr(krs#rst%atu#ruw%awx&Vxz%a{|#r|!O%a!O!P!Gh!Q![!Le![!]*[!]!a%a!a!b!Ip!b!c#r!c!}!Gh#O#P!Ip#Q#R%a#R#S!Gh#S#T#r#T#o!Gh#o#p%a#p#q#r#q#r%a#r$Lv#r$Lv$Lw!J_$Lw;'S#r;'S;=`/R<%lO#r~!Nvom~[~Op#rpq%aqr(krs#rst%atu!'Vuw%awx&Vxz%a{|#r|!O%a!O!P!Gh!Q![!Le![!]!*e!]!a%a!a!b!Ip!b!c#r!c!}#!w#O#P!Ip#Q#R%a#R#S!Gh#S#T#r#T#o#!w#o#p%a#p#q#r#q#r%a#r$Lv#r$Lv$Lw!J_$Lw;'S#r;'S;=`/R<%lO#r~##Oom~[~Op#rpq%aqr(krs#rst%atu!'Vuw%awx&Vxz%a{|#r|!O%a!O!P!Gh!Q![!Le![!]!*e!]!a%a!a!b!Ip!b!c#r!c!}!Gh#O#P!Ip#Q#R%a#R#S!Gh#S#T#r#T#o!Gh#o#p%a#p#q#r#q#r%a#r$Lv#r$Lv$Lw!J_$Lw;'S#r;'S;=`/R<%lO#r~#%WW!n~[~!O!P!Ip!Q![!Ip!a!b!Ip!c!}!Ip#O#P!Ip#R#S!Ip#T#o!Ip$Lv$Lw!Ipf#%uZ!cbOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%a]#&mZ!iXOw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%aV#'eZ!lROw%awx&Vxz%a{!P%a!Q![%a![!]&e!]!a%a!b!}%a#Q;'S%a;'S;=`(e<%lO%a",tokenizers:[es,eg,em,0,1,2,3,4],topRules:{Script:[0,6]},specialized:[{term:76,get:(e,t)=>eO(e,t)<<1,external:eO},{term:29,get:(e,t)=>ey(e,t)<<1|1,external:ey,extend:!0},{term:77,get:(e,t)=>ev(e,t)<<1,external:ev},{term:12,get:(e,t)=>eS(e,t)<<1,external:eS}],tokenPrec:1353});var ew=e.i(42297),ex=e.i(474754),eP=e.i(868275);let eC=a.StateEffect.define(),eE={"en-US":()=>e.A(163894)};async function ek(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en-US",n=null!=(e=eE[t])?e:eE["en-US"];return n?(await n()).default.formulas:{}}async function eQ(e,t){let n=(0,p.syntaxTree)(e).resolveInner(t).enterUnfinishedNodesBefore(t);if("ArgList"!==n.name||!n.parent)return null;let r=n.parent.getChild("BuiltInFunctionName")||n.parent.getChild("FunctionName");if(!r)return null;let o=await eA(r,e.doc);if(!o)return null;let a=0;for(let e=t;;){let t=n.childBefore(e);if(!t)break;t.type.is("Separator")&&a++,e=t.from}return()=>(function(e,t){let n=document.createElement("div");for(let r of(n.className="cm-argumentHints",[e.parameters.map(eR)])){let o=document.createElement("span");for(let e=0;e<r.length;e++){let n=r[e];if(void 0!==n){if(e===t||e<t&&n.startsWith("...")){let e=document.createElement("span");e.className="cm-activeArg",o.appendChild(e).appendChild(document.createTextNode(n))}else o.appendChild(document.createTextNode(n));e<r.length-1&&o.appendChild(document.createTextNode(", "))}}let a=n.appendChild(document.createElement("div"));a.className="source-code",a.appendChild(document.createTextNode(e.id)),a.appendChild(document.createTextNode("(")),a.appendChild(o),a.appendChild(document.createTextNode(")"))}let r=n.appendChild(document.createElement("div"));return r.className="cm-description",r.appendChild(document.createTextNode(e.description||"")),r.append(),{dom:n}})(o,a)}let eR=e=>(e.repeating?"...".concat(e.name):e.optional?"[".concat(e.name,"]"):e.name)+(e.type?": ".concat(e.type):"");async function eA(e,t){var n;let r=t.sliceString(e.from,e.to);return null!=(n=(await ek("en-US"))[r])?n:null}var eT=e.i(728243),eN=e.i(701856);function eW(e){let t=[];return(0,p.syntaxTree)(e).iterate({enter:n=>{if("Reference"===n.name){let r=e.doc.sliceString(n.from,n.to),o=(0,eN.addressToRange)(r);return void 0===o||(t.push({from:n.from,to:n.to,selection:new f.CellSelection(o.anchor,o.head)}),!1)}}}),t}let eq=a.StateField.define({create:e=>eW(e),update:(e,t)=>t.docChanged?eW(t.state):e,provide:e=>eT.cellReferencesFacet.from(e)});var eI=e.i(874838);let eM=eb.configure({props:[p.indentNodeProp.add({Application:(0,p.delimitedIndent)({closing:")",align:!1})}),p.foldNodeProp.add({Application:p.foldInside}),(0,h.styleTags)({"Reference/...":h.tags.color,"RangeToken!":h.tags.tagName,CellToken:h.tags.tagName,ColRangeToken:h.tags.tagName,RowRangeToken:h.tags.tagName,RefErrorToken:h.tags.invalid,BoolToken:h.tags.bool,ErrorToken:h.tags.invalid,NumberToken:h.tags.number,TextToken:h.tags.string,FunctionName:h.tags.function(h.tags.name),BuiltInFunctionName:h.tags.function(h.tags.name),"( )":h.tags.paren,"[ ]":h.tags.squareBracket,"{ }":h.tags.brace})]});function eX(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return/^[=+-]/.test(e)?[function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=function(e){let{locale:t="en-US",decimalSeparator:n="."}=e;return p.LRLanguage.define({name:"spreadsheet",parser:eM.configure({tokenizers:[{from:n,to:eu(n)},{from:eg,to:ef(n)},{from:eO,to:eh(n)}]}),languageData:{autocomplete:async function(e){let n=Object.values(await ek(t));if(!n)return null;let r=(0,p.syntaxTree)(e.state).resolveInner(e.pos,-1);if("FunctionName"!==r.name&&"BuiltInFunctionName"!==r.name&&"NameToken"!==r.name)return null;let o=e.matchBefore(/\w*/);return(!o||o.from!=o.to||e.explicit)&&o?{from:o.from,options:n.map(e=>(0,eI.snippetCompletion)("".concat(e.id,"(#{1})"),{label:e.id,type:"function",apply:"".concat(e.id),info:e.description}))}:null}}})}(t),r=null!=(e=t.readOnly)&&e;return new p.LanguageSupport(n,[u.monoFontFamily,eq,eT.cellHighlights,...r?[]:[function(e){var t,n;let r=a.StateEffect.define();return[a.StateField.define({create:()=>null,update(e,t){if(t.selection&&(e=null),e&&!t.changes.empty){let n=t.changes.mapPos(e.pos,-1,a.MapMode.TrackDel);e=null===n?null:{pos:n,create:e.create,above:!0}}for(let n of t.effects)n.is(r)?e={pos:t.state.selection.main.from,create:n.value,above:!0}:n.is(eC)&&(e=null);return e},provide:e=>i.showTooltip.from(e)}),i.ViewPlugin.fromClass((t=new WeakSet,n=new WeakSet,class{update(e){this.updateID++,e.transactions.some(e=>e.selection)&&e.state.selection.main.empty&&(0,ew._)(this,t,o).call(this,e.view)}constructor(){(0,ex._)(this,t),(0,ex._)(this,n),(0,eP._)(this,"pending",-1),(0,eP._)(this,"updateID",0)}}))];function o(e){this.pending>-1&&clearTimeout(this.pending),this.pending=window.setTimeout(()=>(0,ew._)(this,n,l).call(this,e),50)}function l(n){this.pending=-1;let{main:a}=n.state.selection;if(a.empty){let{updateID:i}=this;e(n.state,a.from).then(e=>{this.updateID!==i?this.pending<0&&(0,ew._)(this,t,o).call(this,n):e?n.dispatch({effects:r.of(e)}):n.dispatch({effects:eC.of(null)})})}}}(eQ)]])}({readOnly:t}),(0,f.cellMode)()]:[]}var eD=e.i(517166);let ej=i.EditorView.theme({"& .cm-scroller":{fontFamily:"var(--cm-mono-font, inherit)"},"&":{backgroundColor:"var(--gdg-bg-cell)",color:"var(--gdg-text-dark)"},"& .cm-cursor, & .cm-dropCursor":{borderLeftColor:"var(--gdg-text-dark)"},"&.cm-focused":{outline:"none"},"&.cm-focused .cm-selectionBackground, ::selection":{backgroundColor:"color-mix(in srgb, var(--gdg-accent-color), transparent 66%) !important"},"& .cm-line":{padding:"0 1px"},".cm-tooltip":{backgroundColor:"var(--gdg-bg-cell)",color:"var(--gdg-text-dark)",border:"0px solid var(--gdg-border-color)",boxShadow:"0 0 0 1px var(--gdg-border-color)",borderRadius:"2px",textAlign:"initial"},".cm-tooltip.cm-tooltip-autocomplete":{padding:"0"},".cm-tooltip.cm-tooltip-autocomplete .cm-completionDetail":{color:"var(--gdg-text-header)",fontStyle:"normal"},".cm-tooltip.cm-tooltip-autocomplete > ul":{fontFamily:"var(--cm-mono-font, inherit)"},".cm-completionIcon":{paddingRight:"0.125rem"},".cm-completionMatchedText":{textDecoration:"initial"},".cm-tooltip.cm-tooltip-autocomplete > ul > li":{padding:"0.25rem 0.50rem"},".cm-tooltip.cm-tooltip-autocomplete > ul > li[aria-selected]":{backgroundColor:"color-mix(in srgb, var(--gdg-accent-color), transparent 66%) !important",color:"var(--gdg-text-dark)"},".cm-argumentHints":{display:"flex",flexDirection:"column",padding:"0.25rem 0.50rem",pointerEvents:"none",whiteSpace:"nowrap",lineHeight:"20px",marginBottom:"4px",width:"fit-content"},".cm-argumentHints .source-code":{fontFamily:"var(--cm-mono-font, inherit)",textWrap:"nowrap"},".cm-argumentHints .cm-activeArg":{backgroundColor:"color-mix(in srgb, var(--gdg-accent-color), transparent 66%) !important"},".cm-description":{color:"var(--gdg-text-header)",textWrap:"pretty"},".cm-tooltip.cm-completionInfo":{color:"var(--gdg-text-header)"},".cm-tooltip.cm-completionInfo.cm-completionInfo-right, .cm-tooltip.cm-completionInfo.cm-completionInfo-left":{margin:"0px 1px"},".cm-cell-range-marker":{color:"var(--gdg-text-light)"},".cm-underline .cm-cell-reference":{textDecoration:"underline"}}),ez=l.default.memo(function(e){let{className:t="",editable:n=!0,readOnly:f=!1,selectAllAtStart:p=!1,autoFocus:h=!1,initialValue:m="",placeholder:g="Empty",onChange:O=()=>null,onHighlightRegions:v=()=>{},cell:S}=e,y=(0,c.useSpreadsheet)(!1),b=l.default.useRef(null),w=l.default.useRef(null);return l.default.useEffect(()=>{if(!w.current)return;let e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.state.facet(eT.cellHighlightsFacet);(e.hasFocus||!(t.length>0))&&(null==v||v(t.map(e=>{let{color:t,range:n}=e;return{color:t+"40",range:n}})))},t=i.EditorView.updateListener.of(t=>{t.docChanged&&(O(t.state.doc.toString()),e(t.view))}),r=new i.EditorView({state:a.EditorState.create({doc:m,extensions:[ej,t,u.basicSetup,u.singleLineSetup,(0,i.placeholder)(g),a.Prec.low(u.sansFontFamily),a.EditorState.readOnly.of(f),i.EditorView.editable.of(n),i.EditorView.contentAttributes.of({tabindex:"0"}),function(e){let{initialDoc:t="",readOnly:n=!1}=e,r=new a.Compartment;return[r.of(eX(t,n)),a.EditorState.transactionExtender.of(e=>{if(!e.docChanged||!e.changes.touchesRange(0))return null;let t=e.state.facet(a.EditorState.readOnly)&&!e.state.facet(i.EditorView.editable);return{effects:r.reconfigure(eX(e.newDoc.sliceString(0,1),t))}})]}({initialDoc:m,readOnly:f}),eD.sheetStateCompartment.of(eD.spreadsheetState.of({...eD.DEFAULT_SPREADSHEET_STATE})),eD.sheetViewCompartment.of(eD.spreadsheetView.of({cellFromPointer:e=>{var t,n;let r=null==(n=e.target)||null==(t=n.closest("[data-sheet-id]"))?void 0:t.dataset.sheetId;if(!r)return;let o=null==y?void 0:y.gridRefs[Number(r)],a=null==o?void 0:o.getMouseArgsForPosition(e.clientX,e.clientY,e);if(!a||"cell"!=a.kind&&"header"!=a.kind)return;let[i,l]=a.location;return{col:i,row:l,sheet:Number(r)}},scrollToCell:e=>{let t=null==y?void 0:y.gridRefs[e.sheet];null==t||t.scrollTo(e.col,e.row)}})),eT.cellHighlights,i.EditorView.domEventHandlers({focus(t,n){e(n)},blur(t,n){e(n,[])}})]}),parent:w.current});h&&r.focus(),p?(0,o.selectAll)(r):(0,o.cursorDocEnd)(r),(0,eD.updateSpreadsheetState)({cell:S})(r);let l=e=>(0,d.handlePointerDown)(e,r),s=r.win;return s.addEventListener("pointerdown",l,!0),b.current=r,y&&(y.editor=r),()=>{r.destroy(),b.current=null,s.removeEventListener("pointerdown",l,!0),y&&y.editor===r&&(y.editor=void 0)}},[]),l.default.useEffect(function(){b.current&&(0,eD.updateSpreadsheetState)({cell:S})(b.current)},[S]),(0,r.jsx)("div",{className:(0,s.cn)("data-grid-editor",t),ref:w,style:{margin:"auto 0"},id:"formula-editor"})});function e_(e){let{initialValue:t="",onSubmit:n,onCancel:o,...a}=e,[i,s]=l.default.useState(t),c=l.default.useCallback(e=>{let t=[0,0],r=!1;switch(e.key){case"Escape":e.preventDefault(),e.stopPropagation(),t=[0,0];break;case"Enter":e.preventDefault(),e.stopPropagation(),t=[0,e.shiftKey?-1:1],r=!0;break;case"Tab":e.preventDefault(),e.stopPropagation(),t=[e.shiftKey?-1:1,0],r=!0;break;default:return}r?n(i,t):o()},[i,n,o]);return(0,r.jsx)("div",{className:"contents",onKeyDown:c,style:{"--gdg-bg-cell":"var(--surface-l1)","--gdg-text-dark":"hsl(var(--fg-primary))","--gdg-text-header":"hsl(var(--fg-primary))","--gdg-border-color":"var(--border-l1)","--gdg-accent-color":"#0ea5e9"},children:(0,r.jsx)(ez,{...a,onChange:s,initialValue:t})})}let eB=l.default.memo(function(e){let{onFinishedEditing:t,value:n,isHighlighted:o}=e,a=(0,c.useSpreadsheet)(),i=a.editingCell,s=l.default.useRef(n);s.current=n;let u=l.default.useCallback((e,n)=>t({...s.current,data:e},n),[t]);return i?(0,r.jsx)(e_,{editable:!0!==n.readonly,readOnly:!0===n.readonly,autoFocus:!0,selectAllAtStart:o&&!1,initialValue:n.data,cell:i,onSubmit:u,onCancel:()=>t(void 0),onHighlightRegions:e=>a.setNodeProps({highlights:e})}):null}),eV=e=>({editor:eB,styleOverride:{textAlign:e.contentAlign,padding:"0 calc(var(--gdg-cell-horizontal-padding) - 0.5px)",display:"flex",justifyItems:"center"},disablePadding:!0}),eF=eV}]);
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="a4d598e0-e2ec-5c44-a5b2-ceaadc738924")}catch(e){}}();
//# debugId=a4d598e0-e2ec-5c44-a5b2-ceaadc738924
